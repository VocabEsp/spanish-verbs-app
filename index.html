<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pr√°ctica de Verbos en Espa√±ol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chosen Palette: Calm Harmony (Stone, Teal) -->
    <!-- Application Structure Plan: A tab-based SPA with sections for each major verb tense (Presente, Pret√©rito Indefinido, etc.) and a comparison view. This structure allows users to focus on one concept at a time, which is better for learning than a long, scrolling document. The core of each section is an interactive verb conjugator and a practice quiz, turning the static reference material into an active learning tool. This task-oriented design directly addresses the user's goal of practicing conjugations. A new "Identificar Verbo" tab is added to allow users to find the base form of a given conjugated verb, and now, to identify its full conjugation details (tense, person, infinitive), enhancing exploration and understanding of verb roots and forms. -->
    <!-- Visualization & Content Choices: 
        - Tense Explanations (Inform): Presented as structured HTML text (lists, paragraphs) for clarity.
        - Conjugation Tables (Organize): Static tables from the report are made dynamic. A user inputs a verb, and JS populates the table. This makes the data explorable. Library: Vanilla JS + HTML Table.
        - Interactive Conjugator (Engage): An input/button combo allows users to see conjugations for any verb, promoting exploration beyond the listed examples. Method: JS DOM manipulation.
        - Practice Quiz (Engage/Test): A simple fill-in-blank quiz provides active recall practice, a key to memorization. Method: JS logic.
        - Infinitive Finder (Organize/Engage): A new input/button allows users to find the infinitive of a given conjugated form, leveraging a predefined lookup table for common verbs. Method: JS DOM manipulation and lookup.
        - Random Verb Suggester (Engage): A button that randomly selects a verb and starts the practice, promoting varied practice without manual input. Method: JS random selection and event triggering.
        - Conjugation Identifier (Organize/Engage): A new input/button allows users to identify the tense, person, and infinitive of a given conjugated verb form. This relies on dynamically generating and comparing all known conjugations. Method: JS dynamic generation and comparison.
        - Justification: This approach directly converts the passive information of the source report into an interactive, hands-on learning experience focused on the user's specific weak points (conjugation and verb identification).
        - No Chart.js/Plotly needed as the content is grammatical, not statistical. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; }
        .tab-active { 
            border-color: #0d9488; 
            background-color: #ccfbf1;
            color: #134e4a;
            font-weight: 600;
        }
        .table-cell {
            padding: 0.75rem;
            border: 1px solid #e5e7eb;
            text-align: center;
        }
        .table-header {
            background-color: #f3f4f6;
            font-weight: 600;
        }
        .feedback-correct {
            color: #059669;
            font-weight: bold;
        }
        .feedback-incorrect {
            color: #dc2626;
            font-weight: bold;
        }
        .feedback-icon {
            margin-left: 0.5rem;
            font-size: 1.2em;
        }
        .mode-button {
            @apply px-4 py-2 rounded-md text-sm font-medium transition;
        }
        .mode-active {
            @apply bg-teal-100 text-teal-800;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-stone-50 text-stone-800">

    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-teal-800">üá™üá∏ Aplicaci√≥n de Verbos en Espa√±ol</h1>
            <p class="text-stone-600 mt-2">Una herramienta interactiva para dominar las conjugaciones verbales.</p>
        </header>

        <nav class="flex flex-wrap justify-center border-b-2 border-stone-200 mb-8 gap-2">
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="presente">Presente</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="indefinido">P. Indefinido</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="imperfecto">P. Imperfecto</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="perfecto">P. Perfecto</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="futuro">Futuro Simple</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="condicional">Condicional</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="presente-subjuntivo">P. Subjuntivo</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="imperfecto-subjuntivo">Imp. Subjuntivo</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="pluscuamperfecto">Pluscuam.</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="futuro-perfecto">F. Perfecto</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="condicional-perfecto">C. Perfecto</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="imperativo">Imperativo</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="comparacion">Comparaci√≥n</button>
            <button class="tab-btn px-4 py-3 border-b-4 border-transparent text-stone-600 hover:bg-stone-100 transition" data-tab="identificar-verbo">Identificar Verbo</button>
        </nav>

        <main id="content-area">
            <!-- Presente de Indicativo -->
            <div id="presente" class="tab-content space-y-8">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Presente de Indicativo</h2>
                    <p class="mb-4 text-stone-600">El presente de indicativo es uno de los tiempos m√°s fundamentales. Se utiliza para describir acciones que ocurren en el momento actual, h√°bitos o rutinas, verdades universales y hechos generales, o incluso para referirse a acciones futuras muy cercanas o planificadas.</p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Acciones actuales:</b> <i>Yo <b>hablo</b> espa√±ol.</i> (I speak/am speaking Spanish.)</li>
                        <li><b>H√°bitos y rutinas:</b> <i>Ella <b>come</b> fruta cada d√≠a.</i> (She eats fruit every day.)</li>
                        <li><b>Verdades generales:</b> <i>La Tierra <b>es</b> redonda.</i> (The Earth is round.)</li>
                        <li><b>Futuro cercano:</b> <i>Ma√±ana <b>voy</b> al cine.</i> (Tomorrow I go/am going to the cinema.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Verbos Regulares:</b> Siguen patrones predecibles al eliminar la terminaci√≥n (-ar, -er, -ir) y a√±adir las desinencias correspondientes.</li>
                        <li><b>Verbos Irregulares Comunes:</b> Muchos verbos de uso frecuente son irregulares (e.g., *ser, estar, ir, tener, hacer, poder, querer, decir*). Algunos tienen cambios voc√°licos (e.g., e>ie en *querer*, o>ue en *poder*) o irregularidades en la primera persona del singular (e.g., *hacer > hago*, *salir > salgo*).</li>
                    </ul>
                </div>

                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="presente">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="presente">Practicar Conjugaci√≥n</button>
                </div>

                <div id="presente-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en Presente</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-presente" placeholder="Escribe un verbo (e.g., cantar, ser)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-presente" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-presente" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>

                <div id="presente-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en Presente</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-presente" placeholder="Escribe un verbo (e.g., hablar, comer)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-presente" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-presente" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-presente" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-presente" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                            </select>
                        </div>
                        <div id="practice-table-presente" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-presente" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-presente" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-presente" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pret√©rito Indefinido -->
            <div id="indefinido" class="tab-content space-y-8 hidden">
                 <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Pret√©rito Indefinido</h2>
                    <p class="mb-4 text-stone-600">El pret√©rito indefinido (o pret√©rito perfecto simple) se utiliza para describir acciones completadas en el pasado. Se enfoca en el principio y el fin de un evento espec√≠fico, como una fotograf√≠a de un momento que ya termin√≥ y no tiene conexi√≥n directa con el presente.</p>
                     <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Acciones completadas:</b> <i>Ayer <b>com√≠</b> paella.</i> (Yesterday I ate paella.)</li>
                        <li><b>Secuencia de eventos:</b> <i>Me <b>levant√©</b>, <b>desayun√©</b> y <b>sal√≠</b>.</i> (I got up, had breakfast, and left.)</li>
                        <li><b>Eventos espec√≠ficos:</b> <i>La guerra <b>empez√≥</b> en 1936.</i> (The war started in 1936.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Verbos Regulares:</b> Las terminaciones son distintas para verbos -AR y para -ER/-IR.</li>
                        <li><b>Verbos Irregulares Comunes:</b> Muchos verbos importantes son irregulares y tienen ra√≠ces y terminaciones √∫nicas (e.g., *ser/ir > fui*, *hacer > hice*, *tener > tuve*, *estar > estuve*). Estos deben memorizarse.</li>
                        <li><b>Cambios Ortogr√°ficos:</b> Algunos verbos regulares tienen cambios ortogr√°ficos en la primera persona del singular para mantener el sonido (e.g., *buscar > busqu√©*, *empezar > empec√©*).</li>
                    </ul>
                </div>
                
                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="indefinido">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="indefinido">Practicar Conjugaci√≥n</button>
                </div>

                <div id="indefinido-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en P. Indefinido</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-indefinido" placeholder="Escribe un verbo (e.g., hablar, ir)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-indefinido" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-indefinido" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>

                <div id="indefinido-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en P. Indefinido</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-indefinido" placeholder="Escribe un verbo (e.g., comer, ir)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-indefinido" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-indefinido" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-indefinido" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-indefinido" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                            </select>
                        </div>
                        <div id="practice-table-indefinido" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-indefinido" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-indefinido" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-indefinido" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pret√©rito Imperfecto -->
            <div id="imperfecto" class="tab-content space-y-8 hidden">
                 <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Pret√©rito Imperfecto</h2>
                    <p class="mb-4 text-stone-600">El pret√©rito imperfecto se usa para describir acciones habituales o repetidas en el pasado, acciones que estaban en progreso, o para establecer el escenario o dar descripciones de personas, lugares o situaciones en el pasado. Se enfoca en la continuidad o la descripci√≥n, no en la finalizaci√≥n.</p>
                     <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Acciones en progreso:</b> <i>Mientras <b>com√≠a</b>, son√≥ el tel√©fono.</i> (While I was eating, the phone rang.)</li>
                        <li><b>Acciones habituales:</b> <i>Cuando era ni√±o, <b>jugaba</b> mucho.</i> (When I was a child, I used to play a lot.)</li>
                        <li><b>Descripciones (personas, lugares, tiempo):</b> <i>La casa <b>era</b> grande.</i> (The house was big.) / <i><b>Eran</b> las tres.</i> (It was three o'clock.)</li>
                        <li><b>Edad en el pasado:</b> <i><b>Ten√≠a</b> diez a√±os.</i> (He was ten years old.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Verbos Regulares:</b> Siguen patrones muy consistentes para -AR y -ER/-IR.</li>
                        <li><b>Verbos Irregulares:</b> ¬°Solo hay tres verbos irregulares en el imperfecto! (*ser, ir, ver*). Esto lo hace uno de los tiempos m√°s f√°ciles de conjugar una vez que conoces estos tres.</li>
                    </ul>
                </div>

                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="imperfecto">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="imperfecto">Practicar Conjugaci√≥n</button>
                </div>

                <div id="imperfecto-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en P. Imperfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-imperfecto" placeholder="Escribe un verbo (e.g., jugar, ser)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-imperfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-imperfecto" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>

                <div id="imperfecto-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en P. Imperfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-imperfecto" placeholder="Escribe un verbo (e.g., comer, ser)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-imperfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-imperfecto" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-imperfecto" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-imperfecto" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                            </select>
                        </div>
                        <div id="practice-table-imperfecto" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-imperfecto" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-imperfecto" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-imperfecto" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pret√©rito Perfecto -->
            <div id="perfecto" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Pret√©rito Perfecto Compuesto</h2>
                    <p class="mb-4 text-stone-600">El pret√©rito perfecto compuesto se utiliza para expresar acciones que han ocurrido en un pasado reciente (un per√≠odo de tiempo que a√∫n no ha terminado, como "hoy" o "esta semana") o para describir experiencias de vida sin especificar un momento concreto. Implica una conexi√≥n o relevancia con el presente.</p>
                     <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Pasado reciente (com√∫n en Espa√±a):</b> <i>Hoy <b>he comido</b> paella.</i> (Today I have eaten paella.)</li>
                        <li><b>Experiencias de vida:</b> <i>Nunca <b>he visitado</b> Asia.</i> (I have never visited Asia.)</li>
                        <li><b>Acciones con relevancia actual:</b> <i><i>No <b>he terminado</b> el trabajo.</i></i> (I haven't finished the work.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li>Es un tiempo compuesto: se forma con el presente del verbo auxiliar *haber* + el participio pasado del verbo principal.</li>
                        <li><b>Participios Regulares:</b> Los verbos -AR forman su participio con *-ado* (e.g., *hablado*). Los verbos -ER/-IR forman su participio con *-ido* (e.g., *comido, vivido*).</li>
                        <li><b>Participios Irregulares:</b> Muchos verbos tienen participios irregulares (e.g., *hacer > hecho, ver > visto, decir > dicho*).</li>
                    </ul>
                </div>

                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="perfecto">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="perfecto">Practicar Conjugaci√≥n</button>
                </div>

                <div id="perfecto-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en P. Perfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-perfecto" placeholder="Escribe un verbo (e.g., hacer, ver)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-perfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-perfecto" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>

                <div id="perfecto-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en P. Perfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-perfecto" placeholder="Escribe un verbo (e.g., hacer, ver)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-perfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-perfecto" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-perfecto" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-perfecto" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                            </select>
                        </div>
                        <div id="practice-table-perfecto" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-perfecto" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-perfecto" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-perfecto" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Futuro Simple -->
            <div id="futuro" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Futuro Simple</h2>
                    <p class="mb-4 text-stone-600">El futuro simple se utiliza para expresar acciones que ocurrir√°n en el futuro, promesas, intenciones o suposiciones sobre el presente. Se forma a√±adiendo las terminaciones al infinitivo del verbo.</p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Acciones futuras:</b> <i>Ma√±ana <b>ir√©</b> al trabajo.</i> (Tomorrow I will go to work.)</li>
                        <li><b>Promesas:</b> <i>Te <b>ayudar√©</b> con la tarea.</i> (I will help you with the homework.)</li>
                        <li><b>Suposiciones sobre el presente:</b> <i>¬øD√≥nde estar√° Juan? <b>Estar√°</b> en casa.</i> (Where could Juan be? He's probably at home.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Formaci√≥n Regular:</b> Se a√±ade la misma terminaci√≥n a todos los infinitivos (-ar, -er, -ir).</li>
                        <li><b>Verbos Irregulares:</b> Algunos verbos tienen ra√≠ces irregulares en el futuro, pero las terminaciones son las mismas que las regulares (e.g., *hacer > har-*, *decir > dir-*, *poder > podr-*).</li>
                    </ul>
                </div>

                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="futuro">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="futuro">Practicar Conjugaci√≥n</button>
                </div>

                <div id="futuro-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en Futuro Simple</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-futuro" placeholder="Escribe un verbo (e.g., hablar, hacer)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-futuro" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-futuro" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>

                <div id="futuro-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en Futuro Simple</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-futuro" placeholder="Escribe un verbo (e.g., comer, ir)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-futuro" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-futuro" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-futuro" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-futuro" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                                <option value="irregular_future_cond">Irregulares Futuro/Condicional</option>
                            </select>
                        </div>
                        <div id="practice-table-futuro" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-futuro" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-futuro" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-futuro" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Condicional Simple -->
            <div id="condicional" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Condicional Simple</h2>
                    <p class="mb-4 text-stone-600">El condicional simple se utiliza para expresar acciones hipot√©ticas (lo que pasar√≠a si...), deseos, peticiones educadas o para dar consejos. Al igual que el futuro, se forma a√±adiendo las terminaciones al infinitivo del verbo.</p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Acciones hipot√©ticas:</b> <i>Si tuviera tiempo, <b>ir√≠a</b> al gimnasio.</i> (If I had time, I would go to the gym.)</li>
                        <li><b>Deseos:</b> <i>Me <b>gustar√≠a</b> viajar m√°s.</i> (I would like to travel more.)</li>
                        <li><b>Peticiones educadas:</b> <i>¬øMe <b>podr√≠as</b> ayudar?</i> (Could you help me?)</li>
                        <li><b>Consejos:</b> <i>Deber√≠as <b>estudiar</b> m√°s.</i> (You should study more.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Formaci√≥n Regular:</b> Se a√±ade la misma terminaci√≥n a todos los infinitivos (-ar, -er, -ir).</li>
                        <li><b>Verbos Irregulares:</b> Los mismos verbos que son irregulares en el futuro tambi√©n lo son en el condicional, y sus ra√≠ces son id√©nticas (e.g., *hacer > har-*, *decir > dir-*, *poder > podr-*).</li>
                    </ul>
                </div>

                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="condicional">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="condicional">Practicar Conjugaci√≥n</button>
                </div>

                <div id="condicional-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en Condicional Simple</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-condicional" placeholder="Escribe un verbo (e.g., hablar, hacer)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-condicional" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-condicional" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>

                <div id="condicional-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en Condicional Simple</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-condicional" placeholder="Escribe un verbo (e.g., comer, ir)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-condicional" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-condicional" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-condicional" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-condicional" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                                <option value="irregular_future_cond">Irregulares Futuro/Condicional</option>
                            </select>
                        </div>
                        <div id="practice-table-condicional" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-condicional" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-condicional" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-condicional" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Presente de Subjuntivo -->
            <div id="presente-subjuntivo" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Presente de Subjuntivo</h2>
                    <p class="mb-4 text-stone-600">El presente de subjuntivo se usa para expresar deseos, emociones, dudas, opiniones negativas, consejos, o situaciones hipot√©ticas. A menudo aparece en oraciones subordinadas introducidas por "que".</p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Deseos/Esperanzas:</b> <i>Espero que <b>vengas</b>.</i> (I hope you come.)</li>
                        <li><b>Emociones:</b> <i>Me alegra que <b>est√©s</b> bien.</i> (I'm glad you are well.)</li>
                        <li><b>Dudas/Incertidumbre:</b> <i>Dudo que <b>sepa</b> la respuesta.</i> (I doubt he knows the answer.)</li>
                        <li><b>Consejos/Peticiones:</b> <i>Te aconsejo que <b>estudies</b>.</i> (I advise you to study.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Formaci√≥n Regular:</b> Para verbos -AR, se usan las terminaciones de -ER/-IR del presente de indicativo (e.g., *hablar > hable*). Para verbos -ER/-IR, se usan las terminaciones de -AR del presente de indicativo (e.g., *comer > coma, vivir > viva*).</li>
                        <li><b>Ra√≠z Irregular:</b> La ra√≠z del subjuntivo presente se deriva de la forma "yo" del presente de indicativo (e.g., *tener > tengo > tenga*).</li>
                        <li><b>Irregulares Comunes:</b> Algunos verbos son completamente irregulares (*ser > sea, ir > vaya, haber > haya, saber > sepa, dar > d√©*).</li>
                    </ul>
                </div>

                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="presente-subjuntivo">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="presente-subjuntivo">Practicar Conjugaci√≥n</button>
                </div>

                <div id="presente-subjuntivo-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en Presente de Subjuntivo</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-presente-subjuntivo" placeholder="Escribe un verbo (e.g., hablar, ser)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-presente-subjuntivo" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-presente-subjuntivo" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>

                <div id="presente-subjuntivo-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en Presente de Subjuntivo</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-presente-subjuntivo" placeholder="Escribe un verbo (e.g., comer, ir)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-presente-subjuntivo" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-presente-subjuntivo" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-presente-subjuntivo" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-presente-subjuntivo" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                                <option value="subjunctive_common_irreg">Irregulares Subjuntivo</option>
                            </select>
                        </div>
                        <div id="practice-table-presente-subjuntivo" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-presente-subjuntivo" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-presente-subjuntivo" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-presente-subjuntivo" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Imperfecto de Subjuntivo -->
            <div id="imperfecto-subjuntivo" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Imperfecto de Subjuntivo</h2>
                    <p class="mb-4 text-stone-600">El imperfecto de subjuntivo se utiliza para expresar deseos, emociones, dudas o situaciones hipot√©ticas en el pasado, o como parte de oraciones condicionales. Tiene dos sets de terminaciones posibles, siendo la forma en -ra la m√°s com√∫n.</p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Deseos en el pasado:</b> <i>Quer√≠a que <b>vinieras</b>.</i> (I wanted you to come.)</li>
                        <li><b>Condicionales (si...):</b> <i>Si <b>tuviera</b> dinero, viajar√≠a.</i> (If I had money, I would travel.)</li>
                        <li><b>Emociones en el pasado:</b> <i>Me alegr√≥ que <b>estuvieras</b> all√≠.</i> (It made me happy that you were there.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Formaci√≥n:</b> Se forma a partir de la tercera persona del plural del pret√©rito indefinido (e.g., *hablaron*, *comieron*, *vivieron*). Se elimina la terminaci√≥n *-ron* y se a√±aden las terminaciones del imperfecto de subjuntivo.</li>
                        <li><b>Dos Formas:</b> Existen dos conjuntos de terminaciones (-ra y -se), pero la forma en *-ra* es la m√°s com√∫n en el uso diario.</li>
                        <li><b>Irregulares:</b> Los verbos irregulares en el pret√©rito indefinido tambi√©n lo ser√°n en el imperfecto de subjuntivo, ya que su ra√≠z se deriva de all√≠ (e.g., *hacer > hicieron > hiciera*).</li>
                    </ul>
                </div>

                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="imperfecto-subjuntivo">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="imperfecto-subjuntivo">Practicar Conjugaci√≥n</button>
                </div>

                <div id="imperfecto-subjuntivo-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en Imperfecto de Subjuntivo</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-imperfecto-subjuntivo" placeholder="Escribe un verbo (e.g., hablar, ser)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-imperfecto-subjuntivo" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-imperfecto-subjuntivo" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>

                <div id="imperfecto-subjuntivo-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en Imperfecto de Subjuntivo</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-imperfecto-subjuntivo" placeholder="Escribe un verbo (e.g., comer, ir)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-imperfecto-subjuntivo" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-imperfecto-subjuntivo" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-imperfecto-subjuntivo" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-imperfecto-subjuntivo" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                                <option value="subjunctive_common_irreg">Irregulares Subjuntivo</option>
                            </select>
                        </div>
                        <div id="practice-table-imperfecto-subjuntivo" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-imperfecto-subjuntivo" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-imperfecto-subjuntivo" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-imperfecto-subjuntivo" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Comparaci√≥n -->
            <div id="comparacion" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Comparaci√≥n de Tiempos del Pasado</h2>
                    <p class="mb-4 text-stone-600">Diferenciar entre los tiempos del pasado es uno de los mayores retos en espa√±ol. Aqu√≠ te explicamos sus usos m√°s comunes para que no los confundas.</p>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="table-cell table-header">Tiempo</th>
                                    <th class="table-cell table-header">Enfoque</th>
                                    <th class="table-cell table-header">Ejemplo</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="table-cell font-semibold">P. Indefinido</td>
                                    <td class="table-cell">Acci√≥n completada (snapshot)</td>
                                    <td class="table-cell"><i>Ayer <b>fui</b> al cine.</i></td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">P. Imperfecto</td>
                                    <td class="table-cell">Acci√≥n habitual/descripci√≥n (background)</td>
                                    <td class="table-cell"><i>Cuando era ni√±o, <b>iba</b> al cine.</i></td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">P. Perfecto</td>
                                    <td class="table-cell">Pasado reciente / Relevancia presente</td>
                                    <td class="table-cell"><i>Esta semana <b>he ido</b> al cine.</i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                     <p class="mt-6 text-stone-600"><b>Escenario Detallado: Contando una Historia</b></p>
                     <p class="mt-2 text-stone-600">Imagina que quieres contar lo que pas√≥ un d√≠a espec√≠fico:</p>
                     <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li>**Imperfecto (para el escenario y acciones en curso):** "Ayer por la tarde, <b>hac√≠a</b> mucho sol y los p√°jaros <b>cantaban</b>. Yo <b>estaba leyendo</b> un libro en el jard√≠n." (Describes the ongoing conditions and what you *were doing*.)</li>
                        <li>**Indefinido (para la acci√≥n principal y completada):** "De repente, <b>son√≥</b> el tel√©fono y mi amigo Juan <b>me llam√≥</b>. √âl <b>me invit√≥</b> a cenar." (Describes specific, completed actions that happened.)</li>
                        <li>**Pret√©rito Perfecto (para acciones recientes con impacto en el presente):** "<b>He hablado</b> con Juan hoy, y <b>hemos decidido</b> ir a un restaurante nuevo." (The conversation and decision happened recently and are still relevant to current plans.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Otro Ejemplo de Contraste (Conocer):</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Pret√©rito:</b> <i>Ayer <b>conoc√≠</b> a una persona muy interesante.</i> (I *met* someone yesterday - a specific event.)</li>
                        <li><b>Imperfecto:</b> <i>Yo ya <b>conoc√≠a</b> a esa persona desde hace tiempo.</i> (I *knew* that person for a while - an ongoing state of knowing.)</li>
                    </ul>
                </div>
            </div>

            <!-- Pluscuamperfecto -->
            <div id="pluscuamperfecto" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Pluscuamperfecto (Past Perfect)</h2>
                    <p class="mb-4 text-stone-600">El pluscuamperfecto se utiliza para expresar una acci√≥n que ocurri√≥ y fue completada *antes* de otra acci√≥n o momento en el pasado. Es el "pasado del pasado".</p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Acci√≥n anterior a otra en el pasado:</b> <i>Cuando llegu√©, Juan ya <b>hab√≠a salido</b>.</i> (When I arrived, Juan had already left.)</li>
                        <li><b>Experiencias antes de un momento pasado:</b> <i>Nunca <b>hab√≠a visto</b> tanta nieve hasta el a√±o pasado.</i> (I had never seen so much snow until last year.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li>Es un tiempo compuesto: se forma con el imperfecto del verbo auxiliar *haber* + el participio pasado del verbo principal.</li>
                        <li><b>Verbo auxiliar *haber* en imperfecto:</b> *hab√≠a, hab√≠as, hab√≠a, hab√≠amos, hab√≠ais, hab√≠an*.</li>
                        <li>Los participios pasados son los mismos que los del pret√©rito perfecto.</li>
                    </ul>
                </div>
                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="pluscuamperfecto">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="pluscuamperfecto">Practicar Conjugaci√≥n</button>
                </div>
                <div id="pluscuamperfecto-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en Pluscuamperfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-pluscuamperfecto" placeholder="Escribe un verbo (e.g., hablar, hacer)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-pluscuamperfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-pluscuamperfecto" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>
                <div id="pluscuamperfecto-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en Pluscuamperfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-pluscuamperfecto" placeholder="Escribe un verbo (e.g., comer, ir)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-pluscuamperfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-pluscuamperfecto" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-pluscuamperfecto" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-pluscuamperfecto" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                                <option value="irregular_future_cond">Irregulares Futuro/Condicional</option>
                                <option value="subjunctive_common_irreg">Irregulares Subjuntivo</option>
                            </select>
                        </div>
                        <div id="practice-table-pluscuamperfecto" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-pluscuamperfecto" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-pluscuamperfecto" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-pluscuamperfecto" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Futuro Perfecto -->
            <div id="futuro-perfecto" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Futuro Perfecto (Future Perfect)</h2>
                    <p class="mb-4 text-stone-600">El futuro perfecto se utiliza para expresar una acci√≥n que habr√° sido completada en el futuro, antes de otro momento o acci√≥n futura. Tambi√©n se usa para expresar una suposici√≥n sobre una acci√≥n que ya se ha completado en el pasado reciente.</p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Acci√≥n completada en el futuro:</b> <i>Para el lunes, <b>habr√© terminado</b> el proyecto.</i> (By Monday, I will have finished the project.)</li>
                        <li><b>Suposici√≥n sobre el pasado:</b> <i>Juan no est√°. <b>Habr√° ido</b> al supermercado.</i> (Juan is not here. He must have gone to the supermarket.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li>Es un tiempo compuesto: se forma con el futuro simple del verbo auxiliar *haber* + el participio pasado del verbo principal.</li>
                        <li><b>Verbo auxiliar *haber* en futuro:</b> *habr√©, habr√°s, habr√°, habremos, habr√©is, habr√°n*.</li>
                        <li>Los participios pasados son los mismos que los del pret√©rito perfecto.</li>
                    </ul>
                </div>
                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="futuro-perfecto">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="futuro-perfecto">Practicar Conjugaci√≥n</button>
                </div>
                <div id="futuro-perfecto-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en Futuro Perfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-futuro-perfecto" placeholder="Escribe un verbo (e.g., hablar, hacer)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-futuro-perfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-futuro-perfecto" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>
                <div id="futuro-perfecto-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en Futuro Perfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-futuro-perfecto" placeholder="Escribe un verbo (e.g., comer, ir)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-futuro-perfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-futuro-perfecto" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-futuro-perfecto" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-futuro-perfecto" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                                <option value="irregular_future_cond">Irregulares Futuro/Condicional</option>
                            </select>
                        </div>
                        <div id="practice-table-futuro-perfecto" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-futuro-perfecto" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-futuro-perfecto" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-futuro-perfecto" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Condicional Perfecto -->
            <div id="condicional-perfecto" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Condicional Perfecto (Conditional Perfect)</h2>
                    <p class="mb-4 text-stone-600">El condicional perfecto se utiliza para expresar acciones que habr√≠an ocurrido en el pasado bajo ciertas condiciones, o para expresar una suposici√≥n sobre una acci√≥n que deber√≠a haber ocurrido en el pasado.</p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Acci√≥n hipot√©tica en el pasado:</b> <i>Si hubiera tenido tiempo, <b>habr√≠a ido</b> al gimnasio.</i> (If I had had time, I would have gone to the gym.)</li>
                        <li><b>Suposici√≥n sobre el pasado:</b> <i>Juan no vino. <b>Habr√≠a estado</b> enfermo.</i> (Juan didn't come. He must have been sick.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li>Es un tiempo compuesto: se forma con el condicional simple del verbo auxiliar *haber* + el participio pasado del verbo principal.</li>
                        <li><b>Verbo auxiliar *haber* en condicional:</b> *habr√≠a, habr√≠as, habr√≠a, habr√≠amos, habr√≠ais, habr√≠an*.</li>
                        <li>Los participios pasados son los mismos que los del pret√©rito perfecto.</li>
                    </ul>
                </div>
                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="condicional-perfecto">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="condicional-perfecto">Practicar Conjugaci√≥n</button>
                </div>
                <div id="condicional-perfecto-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en Condicional Perfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-condicional-perfecto" placeholder="Escribe un verbo (e.g., hablar, hacer)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-condicional-perfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-condicional-perfecto" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>
                <div id="condicional-perfecto-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en Condicional Perfecto</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-condicional-perfecto" placeholder="Escribe un verbo (e.g., comer, ir)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-condicional-perfecto" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-condicional-perfecto" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-condicional-perfecto" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-condicional-perfecto" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                                <option value="irregular_future_cond">Irregulares Futuro/Condicional</option>
                            </select>
                        </div>
                        <div id="practice-table-condicional-perfecto" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-condicional-perfecto" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-condicional-perfecto" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-condicional-perfecto" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Imperativo -->
            <div id="imperativo" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Imperativo (Commands)</h2>
                    <p class="mb-4 text-stone-600">El imperativo se utiliza para dar √≥rdenes, instrucciones, hacer peticiones o sugerencias directas. Tiene formas espec√≠ficas para comandos afirmativos y negativos, y var√≠a seg√∫n la persona (t√∫, vosotros, usted, ustedes, nosotros).</p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Orden afirmativa (t√∫):</b> <i>¬°<b>Habla</b> m√°s alto!</i> (Speak louder!)</li>
                        <li><b>Orden negativa (t√∫):</b> <i>¬°No <b>hables</b>!</i> (Don't speak!)</li>
                        <li><b>Petici√≥n formal (usted):</b> <i>¬°<b>Venga</b> aqu√≠, por favor!</i> (Come here, please!)</li>
                        <li><b>Sugerencia (nosotros):</b> <i>¬°<b>Comamos</b> juntos!</i> (Let's eat together!)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Notas Gramaticales Clave:</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Formaci√≥n Regular:</b>
                            <ul>
                                <li>**T√∫ (afirmativo):** Misma forma que √©l/ella del presente de indicativo (e.g., *hablar > habla, comer > come, vivir > vive*).</li>
                                <li>**Vosotros/as (afirmativo):** Reemplaza la -r del infinitivo por -d (e.g., *hablar > hablad, comer > comed, vivir > vivid*).</li>
                                <li>**Usted/Ustedes/Nosotros (afirmativo y todos los negativos):** Derivan del presente de subjuntivo. Para -AR, usan terminaciones de -ER/-IR del subjuntivo (e.g., *hable, hablen, hablemos*). Para -ER/-IR, usan terminaciones de -AR del subjuntivo (e.g., *coma, coman, comamos*).</li>
                            </ul>
                        </li>
                        <li><b>Irregulares:</b> Muchos verbos comunes son irregulares, especialmente en la forma *t√∫* afirmativa (e.g., *decir > di, hacer > haz, ir > ve, ser > s√©*). Las formas negativas y las formas de usted/ustedes/nosotros de los irregulares del imperativo suelen seguir las irregularidades del presente de subjuntivo.</li>
                    </ul>
                </div>
                <div class="flex justify-center gap-4 mb-6">
                    <button class="mode-button mode-active" data-mode="view" data-tense="imperativo">Ver Conjugaci√≥n</button>
                    <button class="mode-button" data-mode="practice" data-tense="imperativo">Practicar Conjugaci√≥n</button>
                </div>
                <div id="imperativo-view-mode" class="mode-section">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Ver Conjugaci√≥n en Imperativo</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center">
                            <input type="text" id="verb-input-imperativo" placeholder="Escribe un verbo (e.g., ir, hacer)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="conjugate-btn-imperativo" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Conjugar</button>
                        </div>
                        <div id="conjugation-result-imperativo" class="mt-6 overflow-x-auto"></div>
                    </div>
                </div>
                <div id="imperativo-practice-mode" class="mode-section hidden">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-semibold text-teal-700 mb-4">Practicar Conjugaci√≥n en Imperativo</h3>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <input type="text" id="practice-verb-input-imperativo" placeholder="Escribe un verbo (e.g., comer, ser)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                            <button id="start-practice-btn-imperativo" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Empezar Pr√°ctica</button>
                            <button id="random-verb-btn-imperativo" class="w-full sm:w-auto bg-stone-400 text-white px-6 py-2 rounded-md hover:bg-stone-500 transition font-semibold">Sugerir Verbo Aleatorio</button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 items-center mb-4">
                            <label for="practice-category-imperativo" class="text-sm font-medium text-stone-700">Categor√≠a:</label>
                            <select id="practice-category-imperativo" class="w-full sm:w-auto px-3 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                                <option value="all">Todos los verbos</option>
                                <option value="regular_ar">Regulares -AR</option>
                                <option value="regular_er">Regulares -ER</option>
                                <option value="regular_ir">Regulares -IR</option>
                                <option value="irregular_common">Irregulares Comunes</option>
                                <option value="reflexive">Reflexivos</option>
                                <option value="stem_changing_e_ie">Cambio E>IE</option>
                                <option value="stem_changing_o_ue">Cambio O>UE</option>
                                <option value="stem_changing_e_i">Cambio E>I</option>
                                <option value="go_verbs_present">Verbos con -go</option>
                                <option value="z_c_verbs_present">Verbos con -zco</option>
                                <option value="imperative_irreg">Irregulares Imperativo</option>
                            </select>
                        </div>
                        <div id="practice-table-imperativo" class="mt-6 overflow-x-auto"></div>
                        <div id="practice-feedback-imperativo" class="mt-4 text-center font-bold"></div>
                        <div class="flex justify-center gap-4 mt-4">
                            <button id="check-practice-btn-imperativo" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition font-semibold hidden">Comprobar Respuestas</button>
                            <button id="show-practice-btn-imperativo" class="bg-stone-500 text-white px-6 py-2 rounded-md hover:bg-stone-600 transition font-semibold hidden">Mostrar Respuestas</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Comparaci√≥n -->
            <div id="comparacion" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Comparaci√≥n de Tiempos del Pasado</h2>
                    <p class="mb-4 text-stone-600">Diferenciar entre los tiempos del pasado es uno de los mayores retos en espa√±ol. Aqu√≠ te explicamos sus usos m√°s comunes para que no los confundas.</p>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="table-cell table-header">Tiempo</th>
                                    <th class="table-cell table-header">Enfoque</th>
                                    <th class="table-cell table-header">Ejemplo</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="table-cell font-semibold">P. Indefinido</td>
                                    <td class="table-cell">Acci√≥n completada (snapshot)</td>
                                    <td class="table-cell"><i>Ayer <b>fui</b> al cine.</i></td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">P. Imperfecto</td>
                                    <td class="table-cell">Acci√≥n habitual/descripci√≥n (background)</td>
                                    <td class="table-cell"><i>Cuando era ni√±o, <b>iba</b> al cine.</i></td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">P. Perfecto</td>
                                    <td class="table-cell">Pasado reciente / Relevancia presente</td>
                                    <td class="table-cell"><i>Esta semana <b>he ido</b> al cine.</i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                     <p class="mt-6 text-stone-600"><b>Escenario Detallado: Contando una Historia</b></p>
                     <p class="mt-2 text-stone-600">Imagina que quieres contar lo que pas√≥ un d√≠a espec√≠fico:</p>
                     <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li>**Imperfecto (para el escenario y acciones en curso):** "Ayer por la tarde, <b>hac√≠a</b> mucho sol y los p√°jaros <b>cantaban</b>. Yo <b>estaba leyendo</b> un libro en el jard√≠n." (Describes the ongoing conditions and what you *were doing*.)</li>
                        <li>**Indefinido (para la acci√≥n principal y completada):** "De repente, <b>son√≥</b> el tel√©fono y mi amigo Juan <b>me llam√≥</b>. √âl <b>me invit√≥</b> a cenar." (Describes specific, completed actions that happened.)</li>
                        <li>**Pret√©rito Perfecto (para acciones recientes con impacto en el presente):** "<b>He hablado</b> con Juan hoy, y <b>hemos decidido</b> ir a un restaurante nuevo." (The conversation and decision happened recently and are still relevant to current plans.)</li>
                    </ul>
                    <p class="mt-4 text-stone-600"><b>Otro Ejemplo de Contraste (Conocer):</b></p>
                    <ul class="list-disc list-inside space-y-2 text-stone-700">
                        <li><b>Pret√©rito:</b> <i>Ayer <b>conoc√≠</b> a una persona muy interesante.</i> (I *met* someone yesterday - a specific event.)</li>
                        <li><b>Imperfecto:</b> <i>Yo ya <b>conoc√≠a</b> a esa persona desde hace tiempo.</i> (I *knew* that person for a while - an ongoing state of knowing.)</li>
                    </ul>
                </div>
            </div>

            <!-- Identificar Verbo Tab -->
            <div id="identificar-verbo" class="tab-content space-y-8 hidden">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Buscar el Infinitivo</h2>
                    <p class="mb-4 text-stone-600">Introduce una forma verbal conjugada en espa√±ol y te mostrar√© su infinitivo, si est√° en mi base de datos.</p>
                    <div class="flex flex-col sm:flex-row gap-2 items-center">
                        <input type="text" id="word-input-infinitivo" placeholder="Escribe una forma verbal (e.g., hablo, com√≠, fui)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                        <button id="find-infinitive-btn" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Buscar Infinitivo</button>
                    </div>
                    <div id="infinitive-result" class="mt-6 text-lg font-semibold text-stone-700"></div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-sm mt-8">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Identificar Conjugaci√≥n</h2>
                    <p class="mb-4 text-stone-600">Introduce una forma verbal conjugada para identificar su tiempo, persona y el infinitivo al que pertenece.</p>
                    <div class="flex flex-col sm:flex-row gap-2 items-center">
                        <input type="text" id="identify-verb-input" placeholder="Escribe una forma verbal (e.g., cantabas, dir√©)" class="w-full px-4 py-2 border border-stone-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                        <button id="identify-verb-btn" class="w-full sm:w-auto bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition font-semibold">Identificar</button>
                    </div>
                    <div id="identification-result" class="mt-6 text-lg font-semibold text-stone-700"></div>
                </div>
            </div>

        </main>
    </div>

    <script>
        (function() { // IIFE starts here
            const tabs = document.querySelectorAll('.tab-btn');
            const contents = document.querySelectorAll('.tab-content');

            const verbData = {
                presente: {
                    reg: {
                        ar: ['o', 'as', 'a', 'amos', '√°is', 'an'],
                        er: ['o', 'es', 'e', 'emos', '√©is', 'en'],
                        ir: ['o', 'es', 'e', 'imos', '√≠s', 'en']
                    },
                    irreg: {
                        ser: ['soy', 'eres', 'es', 'somos', 'sois', 'son'],
                        estar: ['estoy', 'est√°s', 'est√°', 'estamos', 'est√°is', 'est√°n'],
                        ir: ['voy', 'vas', 'va', 'vamos', 'vais', 'van'],
                        tener: ['tengo', 'tienes', 'tiene', 'tenemos', 'ten√©is', 'tienen'],
                        hacer: ['hago', 'haces', 'hace', 'hacemos', 'hac√©is', 'hacen'],
                        poder: ['puedo', 'puedes', 'puede', 'podemos', 'pod√©is', 'pueden'],
                        querer: ['quiero', 'quieres', 'quiere', 'queremos', 'quer√©is', 'quieren'],
                        decir: ['digo', 'dices', 'dice', 'decimos', 'dec√≠s', 'dicen'],
                        volver: ['vuelvo', 'vuelves', 'vuelve', 'volvemos', 'volv√©is', 'vuelven'] // Added volver
                    }
                },
                indefinido: {
                    reg: {
                        ar: ['√©', 'aste', '√≥', 'amos', 'asteis', 'aron'],
                        er: ['√≠', 'iste', 'i√≥', 'imos', 'isteis', 'ieron'],
                        ir: ['√≠', 'iste', 'i√≥', 'imos', 'isteis', 'ieron']
                    },
                    irreg: {
                        ser: ['fui', 'fuiste', 'fue', 'fuimos', 'fuisteis', 'fueron'],
                        ir: ['fui', 'fuiste', 'fue', 'fuimos', 'fuisteis', 'fueron'],
                        estar: ['estuve', 'estuviste', 'estuvo', 'estuvimos', 'estuvisteis', 'estuvieron'],
                        tener: ['tuve', 'tuviste', 'tuvo', 'tuvimos', 'tuvisteis', 'tuvieron'],
                        hacer: ['hice', 'hiciste', 'hizo', 'hicimos', 'hicisteis', 'hicieron'],
                        poder: ['pude', 'pudiste', 'pudo', 'pudimos', 'pudisteis', 'pudieron'],
                        decir: ['dije', 'dijiste', 'dijo', 'dijimos', 'dijisteis', 'dijeron'],
                        volver: ['volv√≠', 'volviste', 'volvi√≥', 'volvimos', 'volvisteis', 'volvieron']
                    }
                },
                imperfecto: {
                    reg: {
                        ar: ['aba', 'abas', 'aba', '√°bamos', 'abais', 'aban'],
                        er: ['√≠a', '√≠as', '√≠a', '√≠amos', '√≠ais', '√≠an'],
                        ir: ['√≠a', '√≠as', '√≠a', '√≠amos', '√≠ais', '√≠an']
                    },
                    irreg: {
                        ser: ['era', 'eras', 'era', '√©ramos', 'erais', 'eran'],
                        ir: ['iba', 'ibas', 'iba', '√≠bamos', 'ibais', 'iban'],
                        ver: ['ve√≠a', 've√≠as', 've√≠a', 've√≠amos', 've√≠ais', 've√≠an'],
                        volver: ['volv√≠a', 'volv√≠as', 'volv√≠a', 'volv√≠amos', 'volv√≠ais', 'volv√≠an']
                    }
                },
                futuro: {
                    reg: ['√©', '√°s', '√°', 'emos', '√©is', '√°n'], // Endings are added to the infinitive
                    irreg: {
                        decir: ['dir√©', 'dir√°s', 'dir√°', 'diremos', 'dir√©is', 'dir√°n'],
                        hacer: ['har√©', 'har√°s', 'har√°', 'haremos', 'har√©is', 'har√°n'],
                        poder: ['podr√©', 'podr√°s', 'podr√°', 'podremos', 'podr√©is', 'podr√°n'],
                        poner: ['pondr√©', 'pondr√°s', 'pondr√°', 'pondremos', 'pondr√©is', 'pondr√°n'],
                        haber: ['habr√©', 'habr√°s', 'habr√°', 'habremos', 'habr√©is', 'habr√°n'],
                        saber: ['sabr√©', 'sabr√°s', 'sabr√°', 'sabremos', 'sabr√©is', 'sabr√°n'],
                        salir: ['saldr√©', 'saldr√°s', 'saldr√°', 'saldremos', 'saldr√©is', 'saldr√°n'],
                        tener: ['tendr√©', 'tendr√°s', 'tendr√°', 'tendremos', 'tendr√©is', 'tendr√°n'],
                        venir: ['vendr√©', 'vendr√°s', 'vendr√°', 'vendremos', 'vendr√©is', 'vendr√°n'],
                        querer: ['querr√©', 'querr√°s', 'querr√°', 'querremos', 'querr√©is', 'querr√°n'],
                        volver: ['volver√©', 'volver√°s', 'volver√°', 'volveremos', 'volver√©is', 'volver√°n']
                    }
                },
                condicional: {
                    reg: ['√≠a', '√≠as', '√≠a', '√≠amos', '√≠ais', '√≠an'], // Endings are added to the infinitive
                    irreg: {
                        decir: ['dir√≠a', 'dir√≠as', 'dir√≠a', 'dir√≠amos', 'dir√≠ais', 'dir√≠an'],
                        hacer: ['har√≠a', 'har√≠as', 'har√≠a', 'har√≠amos', 'har√≠ais', 'har√≠an'],
                        poder: ['podr√≠a', 'podr√≠as', 'podr√≠a', 'podr√≠amos', 'podr√≠ais', 'podr√≠an'],
                        poner: ['pondr√≠a', 'pondr√≠as', 'pondr√≠a', 'pondr√≠amos', 'pondr√≠ais', 'pondr√≠an'],
                        haber: ['habr√≠a', 'habr√≠as', 'habr√≠a', 'habr√≠amos', 'habr√≠ais', 'habr√≠an'],
                        saber: ['sabr√≠a', 'sabr√≠as', 'sabr√≠a', 'sabr√≠amos', 'sabr√≠ais', 'sabr√≠an'],
                        salir: ['saldr√≠a', 'saldr√≠as', 'saldr√≠a', 'saldr√≠amos', 'saldr√≠ais', 'saldr√≠an'],
                        tener: ['tendr√≠a', 'tendr√≠as', 'tendr√≠a', 'tendr√≠amos', 'tendr√≠ais', 'tendr√≠an'],
                        venir: ['vendr√≠a', 'vendr√≠as', 'vendr√≠a', 'vendr√≠amos', 'vendr√≠ais', 'vendr√≠an'],
                        querer: ['querr√≠a', 'querr√≠as', 'querr√≠a', 'querr√≠amos', 'querr√≠ais', 'querr√≠an'],
                        volver: ['volver√≠a', 'volver√≠as', 'volver√≠a', 'volver√≠amos', 'volver√≠ais', 'volver√≠an']
                    }
                },
                perfecto: {
                    haber: ['he', 'has', 'ha', 'hemos', 'hab√©is', 'han'],
                    participles: {
                        reg: { ar: 'ado', er: 'ido', ir: 'ido' },
                        irreg: {
                            hacer: 'hecho', decir: 'dicho', ver: 'visto',
                            abrir: 'abierto', escribir: 'escrito', poner: 'puesto',
                            volver: 'vuelto', morir: 'muerto', romper: 'roto'
                        }
                    }
                },
                presente_subjuntivo: {
                    reg: {
                        // For -AR verbs, use -ER/-IR endings of Presente de Indicativo
                        ar: ['e', 'es', 'e', 'emos', '√©is', 'en'],
                        // For -ER/-IR verbs, use -AR endings of Presente de Indicativo
                        er: ['a', 'as', 'a', 'amos', '√°is', 'an'],
                        ir: ['a', 'as', 'a', 'amos', '√°is', 'an']
                    },
                    irreg: {
                        ser: ['sea', 'seas', 'sea', 'seamos', 'se√°is', 'sean'],
                        estar: ['est√©', 'est√©s', 'est√©', 'estemos', 'est√©is', 'est√©n'],
                        ir: ['vaya', 'vayas', 'vaya', 'vayamos', 'vay√°is', 'vayan'],
                        haber: ['haya', 'hayas', 'haya', 'hayamos', 'hay√°is', 'hayan'],
                        saber: ['sepa', 'sepas', 'sepa', 'sepamos', 'sep√°is', 'sepan'],
                        dar: ['d√©', 'des', 'd√©', 'demos', 'deis', 'den'],
                        conocer: ['conozca', 'conozcas', 'conozca', 'conozcamos', 'conozc√°is', 'conozcan'], // -zco verbs
                        hacer: ['haga', 'hagas', 'haga', 'hagamos', 'hag√°is', 'hagan'], // -go verbs
                        decir: ['diga', 'digas', 'diga', 'digamos', 'dig√°is', 'digan'],
                        tener: ['tenga', 'tengas', 'tenga', 'tengamos', 'teng√°is', 'tengan'],
                        venir: ['venga', 'vengas', 'venga', 'vengamos', 'veng√°is', 'vengan'],
                        o√≠r: ['oiga', 'oigas', 'oiga', 'oigamos', 'oig√°is', 'oigan'],
                        poder: ['pueda', 'puedas', 'pueda', 'podamos', 'pod√°is', 'puedan'], // Stem-changing o>ue
                        querer: ['quiera', 'quieras', 'quiera', 'queramos', 'quer√°is', 'quieran'], // Stem-changing e>ie
                        pedir: ['pida', 'pidas', 'pida', 'pidamos', 'pid√°is', 'pidan'], // Stem-changing e>i
                        dormir: ['duerma', 'duermas', 'duerma', 'durmamos', 'durm√°is', 'duerman'], // Stem-changing o>ue with u in nosotros/vosotros
                        volver: ['vuelva', 'vuelvas', 'vuelva', 'volvamos', 'volv√°is', 'vuelvan']
                    }
                },
                imperfecto_subjuntivo: {
                    reg: {
                        // Formed from 3rd person plural of Preterite (-ron ending)
                        ar: ['ara', 'aras', 'ara', '√°ramos', 'arais', 'aran'],
                        er: ['iera', 'ieras', 'iera', 'i√©ramos', 'ierais', 'ieran'],
                        ir: ['iera', 'ieras', 'iera', 'i√©ramos', 'ierais', 'ieran']
                    },
                    irreg: {
                        // Irregular stems are based on Preterite irregular stems
                        ser: ['fuera', 'fueras', 'fuera', 'fu√©ramos', 'fuerais', 'fueran'],
                        ir: ['fuera', 'fueras', 'fuera', 'fu√©ramos', 'fuerais', 'fueran'],
                        estar: ['estuviera', 'estuvieras', 'estuviera', 'estuvi√©ramos', 'estuvierais', 'estuvieran'],
                        tener: ['tuviera', 'tuvieras', 'tuviera', 'tuvi√©ramos', 'tuvierais', 'tuvieran'],
                        hacer: ['hiciera', 'hicieras', 'hiciera', 'hici√©ramos', 'hicierais', 'hicieran'],
                        poder: ['pudiera', 'pudieras', 'pudiera', 'pudi√©ramos', 'pudierais', 'pudieran'],
                        decir: ['dijera', 'dijeras', 'dijera', 'dij√©ramos', 'dijerais', 'dijeran'],
                        venir: ['viniera', 'vinieras', 'viniera', 'vini√©ramos', 'vinierais', 'vinieran'],
                        saber: ['supiera', 'supieras', 'supiera', 'supi√©ramos', 'supierais', 'supieran'],
                        poner: ['pusiera', 'pusieras', 'pusiera', 'pusi√©ramos', 'pusierais', 'pusieran'],
                        querer: ['quisiera', 'quisieras', 'quisiera', 'quisi√©ramos', 'quisierais', 'quisieran'],
                        traer: ['trajiera', 'trajieras', 'trajiera', 'traj√©ramos', 'trajierais', 'trajieran'],
                        dormir: ['durmiera', 'durmieras', 'durmiera', 'durmi√©ramos', 'durmierais', 'durmieran'], // e.g. durmieron -> durmiera
                        pedir: ['pidiera', 'pidieras', 'pidiera', 'pidi√©ramos', 'pidierais', 'pidieran'], // e.g. pidieron -> pidiera
                        volver: ['volviera', 'volvieras', 'volviera', 'volvi√©ramos', 'volvierais', 'volvieran']
                    }
                },
                pluscuamperfecto: {
                    haber_imp: ['hab√≠a', 'hab√≠as', 'hab√≠a', 'hab√≠amos', 'hab√≠ais', 'hab√≠an'],
                    participles: {
                        reg: { ar: 'ado', er: 'ido', ir: 'ido' },
                        irreg: {
                            hacer: 'hecho', decir: 'dicho', ver: 'visto',
                            abrir: 'abierto', escribir: 'escrito', poner: 'puesto',
                            volver: 'vuelto', morir: 'muerto', romper: 'roto',
                            traer: 'tra√≠do', o√≠r: 'o√≠do', caer: 'ca√≠do', levantar: 'levantado'
                        }
                    }
                },
                futuro_perfecto: {
                    haber_fut: ['habr√©', 'habr√°s', 'habr√°', 'habremos', 'habr√©is', 'habr√°n'],
                    participles: {
                        reg: { ar: 'ado', er: 'ido', ir: 'ido' },
                        irreg: {
                            hacer: 'hecho', decir: 'dicho', ver: 'visto',
                            abrir: 'abierto', escribir: 'escrito', poner: 'puesto',
                            volver: 'vuelto', morir: 'muerto', romper: 'roto',
                            traer: 'tra√≠do', o√≠r: 'o√≠do', caer: 'ca√≠do', levantar: 'levantado'
                        }
                    }
                },
                condicional_perfecto: {
                    haber_cond: ['habr√≠a', 'habr√≠as', 'habr√≠a', 'habr√≠amos', 'habr√≠ais', 'habr√≠an'],
                    participles: {
                        reg: { ar: 'ado', er: 'ido', ir: 'ido' },
                        irreg: {
                            hacer: 'hecho', decir: 'dicho', ver: 'visto',
                            abrir: 'abierto', escribir: 'escrito', poner: 'puesto',
                            volver: 'vuelto', morir: 'muerto', romper: 'roto',
                            traer: 'tra√≠do', o√≠r: 'o√≠do', caer: 'ca√≠do', levantar: 'levantado'
                        }
                    }
                },
                imperativo: {
                    reg: { // Only for regular affirmative t√∫, and vosotros
                        ar: { tu_aff: 'a', vos_aff: 'ad' },
                        er: { tu_aff: 'e', vos_aff: 'ed' },
                        ir: { tu_aff: 'e', vos_aff: 'id' }
                    },
                    irreg: {
                        // Affirmatives
                        'decir': { tu_aff: 'di', vos_aff: 'decid' },
                        'hacer': { tu_aff: 'haz', vos_aff: 'haced' },
                        'ir': { tu_aff: 've', vos_aff: 'id' },
                        'poner': { tu_aff: 'pon', vos_aff: 'poned' },
                        'salir': { tu_aff: 'sal', vos_aff: 'salid' },
                        'ser': { tu_aff: 's√©', vos_aff: 'sed' },
                        'tener': { tu_aff: 'ten', vos_aff: 'tened' },
                        'venir': { tu_aff: 'ven', vos_aff: 'venid' },
                        'volver': { tu_aff: 'vuelve', vos_aff: 'volved' } // Added volver
                        // All other forms (usted, ustedes, nosotros, and all negative forms) derive from Presente Subjuntivo
                        // We will rely on the conjugate function to get these from presente_subjuntivo
                    }
                }
            };
            const pronouns = ['Yo', 'T√∫', '√âl/Ella/Ud.', 'Nosotros/as', 'Vosotros/as', 'Ellos/as/Uds.'];
            const imperativePronouns = ['T√∫ (afirmativo)', 'T√∫ (negativo)', 'Usted', 'Nosotros/as', 'Vosotros/as (afirmativo)', 'Vosotros/as (negativo)', 'Ustedes'];


            const verbTranslations = {
                'hablar': 'to speak', 'comer': 'to eat', 'vivir': 'to live',
                'cantar': 'to sing', 'estudiar': 'to study', 'aprender': 'to learn',
                'beber': 'to drink', 'escribir': 'to write', 'abrir': 'to open',
                'ser': 'to be', 'estar': 'to be', 'ir': 'to go',
                'tener': 'to have', 'hacer': 'to do/make', 'poder': 'to be able to',
                'querer': 'to want', 'decir': 'to say/tell', 'ver': 'to see',
                'jugar': 'to play', 'salir': 'to leave/go out', 'poner': 'to put',
                'romper': 'to break', 'morir': 'to die', 'volver': 'to return',
                'levantar': 'to lift/raise', 'levantarse': 'to get up',
                'saber': 'to know', 'conocer': 'to know', 'dar': 'to give', 'venir': 'to come', 'leer': 'to read',
                'dormir': 'to sleep', 'pedir': 'to ask for', 'sentir': 'to feel', 'encontrar': 'to find', 'empezar': 'to start', 'pensar': 'to think',
                'traer': 'to bring', 'o√≠r': 'to hear', 'caer': 'to fall'
            };

            const infinitiveLookup = {
                'hablo': 'hablar', 'hablas': 'hablar', 'habla': 'hablar', 'hablamos': 'hablar', 'habl√°is': 'hablar', 'hablan': 'hablar',
                'como': 'comer', 'comes': 'comer', 'come': 'comer', 'comemos': 'comer', 'com√©is': 'comer', 'comen': 'comer',
                'vivo': 'vivir', 'vives': 'vivir', 'vive': 'vivir', 'vivimos': 'vivir', 'viv√≠s': 'vivir', 'viven': 'vivir',
                'canto': 'cantar', 'cantas': 'cantar', 'canta': 'cantar', 'cantamos': 'cantar', 'cant√°is': 'cantar', 'cantan': 'cantar',
                'aprendo': 'aprender', 'aprendes': 'aprender', 'aprende': 'aprender', 'aprendemos': 'aprender', 'aprend√©is': 'aprender', 'aprenden': 'aprender',
                'escribo': 'escribir', 'escribes': 'escribir', 'escribe': 'escribir', 'escribimos': 'escribir', 'escrib√≠s': 'escribir', 'escriben': 'escribir',
                'soy': 'ser', 'eres': 'ser', 'es': 'ser', 'somos': 'ser', 'sois': 'ser', 'son': 'ser',
                'estoy': 'estar', 'est√°s': 'estar', 'est√°': 'estar', 'estamos': 'estar', 'est√°is': 'estar', 'est√°n': 'estar',
                'voy': 'ir', 'vas': 'ir', 'va': 'ir', 'vamos': 'ir', 'vais': 'ir', 'van': 'ir',
                'tengo': 'tener', 'tienes': 'tener', 'tiene': 'tener', 'tenemos': 'tener', 'ten√©is': 'tener', 'tienen': 'tener',
                'hago': 'hacer', 'haces': 'hacer', 'hace': 'hacer', 'hacemos': 'hacer', 'hac√©is': 'hacen',
                'puedo': 'poder', 'puedes': 'poder', 'puede': 'poder', 'podemos': 'poder', 'pod√©is': 'poder', 'pueden': 'poder',
                'quiero': 'querer', 'quieres': 'querer', 'quiere': 'querer', 'queremos': 'querer', 'quer√©is': 'querer', 'quieren': 'querer',
                'digo': 'decir', 'dices': 'decir', 'dice': 'decir', 'decimos': 'decir', 'dec√≠s': 'decir', 'dicen': 'decir',
                'salgo': 'salir', 'sales': 'salir', 'sale': 'salir', 'salimos': 'salir', 'sal√≠s': 'salir', 'salen': 'salir',
                'pongo': 'poner', 'pones': 'poner', 'pone': 'poner', 'ponemos': 'poner', 'pon√©is': 'poner', 'ponen': 'poner',
                'habl√©': 'hablar', 'hablaste': 'hablar', 'habl√≥': 'hablar', 'hablamos': 'hablar', 'hablasteis': 'hablar', 'hablaron': 'hablar',
                'com√≠': 'comer', 'comiste': 'comer', 'comi√≥': 'comer', 'comimos': 'comer', 'comisteis': 'comer', 'comieron': 'comer',
                'viv√≠': 'vivir', 'viviste': 'vivir', 'vivi√≥': 'vivir', 'vivimos': 'vivir', 'vivisteis': 'vivir', 'vivieron': 'vivir',
                'cant√©': 'cantar', 'cantaste': 'cantar', 'cant√≥': 'cantar', 'cantamos': 'cantar', 'cantasteis': 'cantar', 'cantaron': 'cantar',
                'aprend√≠': 'aprender', 'aprendiste': 'aprender', 'aprendi√≥': 'aprender', 'aprendimos': 'aprender', 'aprendisteis': 'aprender', 'aprendieron': 'aprender',
                'escrib√≠': 'escribir', 'escribiste': 'escribir', 'escribi√≥': 'escribir', 'escribimos': 'escribir', 'escribisteis': 'escribir', 'escribieron': 'escribir',
                'levant√©': 'levantar', 'levantaste': 'levantar', 'levant√≥': 'levantar', 'levantamos': 'levantar', 'levantasteis': 'levantar', 'levantaron': 'levantar',
                'fui': 'ir/ser', 'fuiste': 'ir/ser', 'fue': 'ir/ser', 'fuimos': 'ir/ser', 'fuisteis': 'ir/ser', 'fueron': 'ir/ser',
                'estuve': 'estar', 'estuviste': 'estar', 'estuvo': 'estar', 'estuvimos': 'estar', 'estuvisteis': 'estar', 'estuvieron': 'estar',
                'tuve': 'tener', 'tuviste': 'tener', 'tuvo': 'tener', 'tuvimos': 'tener', 'tuvisteis': 'tener', 'tuvieron': 'tener',
                'hice': 'hacer', 'hiciste': 'hacer', 'hizo': 'hacer', 'hicimos': 'hicisteis', 'hicieron': 'hacer',
                'pude': 'poder', 'pudiste': 'poder', 'pudo': 'poder', 'pudimos': 'poder', 'pudisteis': 'poder', 'pudieron': 'poder',
                'dije': 'decir', 'dijiste': 'decir', 'dijo': 'decir', 'dijimos': 'decir', 'dijisteis': 'decir', 'dijeron': 'decir',
                'sal√≠': 'salir', 'saliste': 'salir', 'sali√≥': 'salir', 'salimos': 'salir', 'salisteis': 'salir', 'salieron': 'salir',
                'puse': 'poner', 'pusiste': 'poner', 'puso': 'poner', 'pusimos': 'poner', 'pusisteis': 'poner', 'pusieron': 'poner',
                'vi': 'ver', 'viste': 'ver', 'vio': 'ver', 'vimos': 'ver', 'visteis': 'ver', 'vieron': 'ver',
                'hablaba': 'hablar', 'hablabas': 'hablar', 'hablaba': 'hablar', 'habl√°bamos': 'hablar', 'hablabais': 'hablar', 'hablaban': 'hablar',
                'com√≠a': 'comer', 'com√≠as': 'comer', 'com√≠a': 'comer', 'com√≠amos': 'comer', 'com√≠ais': 'comer', 'com√≠an': 'comer',
                'viv√≠a': 'vivir', 'viv√≠as': 'vivir', 'viv√≠a': 'vivir', 'viv√≠amos': 'vivir', 'viv√≠ais': 'vivir', 'viv√≠an': 'vivir',
                'cantaba': 'cantar', 'cantabas': 'cantar', 'cantaba': 'cantar', 'cant√°bamos': 'cantar', 'cantabais': 'cantar', 'cantaban': 'cantar',
                'aprend√≠a': 'aprender', 'aprend√≠as': 'aprender', 'aprend√≠a': 'aprender', 'aprend√≠amos': 'aprender', 'aprend√≠ais': 'aprender', 'aprend√≠an': 'aprender',
                'escrib√≠a': 'escribir', 'escrib√≠as': 'escribir', 'escrib√≠a': 'escribir', 'escrib√≠amos': 'escribir', 'escrib√≠ais': 'escribir', 'escrib√≠an': 'escribir',
                'levantaba': 'levantar', 'levantabas': 'levantar', 'levant√°bamos': 'levantar', 'levantabais': 'levantar', 'levantaban': 'levantar',
                'era': 'ser', 'eras': 'ser', 'era': 'ser', '√©ramos': 'ser', 'erais': 'ser', 'eran': 'ser',
                'iba': 'ir', 'ibas': 'ir', 'iba': 'ir', '√≠bamos': 'ir', 'ibais': 'ir', 'iban': 'ir',
                've√≠a': 'ver', 've√≠as': 'ver', 've√≠a': 'ver', 've√≠amos': 'ver', 've√≠ais': 'ver', 've√≠an': 've√≠an',
                'hablado': 'hablar', 'comido': 'comer', 'vivido': 'vivir',
                'hecho': 'hacer', 'dicho': 'decir', 'visto': 'ver',
                'abierto': 'abrir', 'escrito': 'escribir', 'puesto': 'poner',
                'vuelto': 'volver', 'muerto': 'morir', 'roto': 'romper',
                'tra√≠do': 'traer', 'o√≠do': 'o√≠r', 'le√≠do': 'leer', 'ca√≠do': 'caer',
                'levantado': 'levantar',
                'comi': 'comer', 'levante': 'levantar', 'levanto': 'levantar',
                'me levanto': 'levantarse', 'te levantas': 'levantarse', 'se levanta': 'levantarse',
                'nos levantamos': 'levantarse', 'os levant√°is': 'levantarse', 'se levantan': 'levantarse',
                'me levante': 'levantarse', 'te levantaste': 'levantarse', 'se levanto': 'levantarse',
                'me levant√©': 'levantar',
                'te levantaste': 'levantar',
                'se levant√≥': 'levantar',
                'nos levantamos': 'levantar',
                'os levantasteis': 'levantar',
                'se levantaron': 'levantar',
                'me levantaba': 'levantarse', 'te levantabas': 'levantarse', 'se levantaba': 'levantarse',
                'nos levant√°bamos': 'levantarse', 'os levantabais': 'levantarse', 'se levantaban': 'levantarse',
                'me he levantado': 'levantarse', 'te has levantado': 'levantarse', 'se ha levantado': 'levantarse',
                'nos hemos levantado': 'levantarse', 'os hab√©is levantado': 'levantarse', 'se han levantado': 'levantarse',
                // Futuro Simple
                'hablar√©': 'hablar', 'hablar√°s': 'hablar', 'hablar√°': 'hablar', 'hablaremos': 'hablar', 'hablar√©is': 'hablar', 'hablar√°n': 'hablar',
                'comer√©': 'comer', 'comer√°s': 'comer', 'comer√°': 'comer', 'comeremos': 'comer', 'comer√©is': 'comer', 'comer√°n': 'comer',
                'vivir√©': 'vivir', 'vivir√°s': 'vivir', 'vivir√°': 'vivir', 'viviremos': 'vivir', 'vivir√©is': 'vivir', 'vivir√°n': 'vivir',
                'dir√©': 'decir', 'dir√°s': 'decir', 'dir√°': 'decir', 'diremos': 'decir', 'dir√©is': 'decir', 'dir√°n': 'decir',
                'har√©': 'hacer', 'har√°s': 'hacer', 'har√°': 'hacer', 'haremos': 'hacer', 'har√©is': 'hacer', 'har√°n': 'hacer',
                'podr√©': 'poder', 'podr√°s': 'poder', 'podr√°': 'poder', 'podremos': 'poder', 'podr√©is': 'poder', 'podr√°n': 'poder',
                // Condicional Simple
                'hablar√≠a': 'hablar', 'hablar√≠as': 'hablar', 'hablar√≠a': 'hablar', 'hablar√≠amos': 'hablar', 'hablar√≠ais': 'hablar', 'hablar√≠an': 'hablar',
                'comer√≠a': 'comer', 'comer√≠as': 'comer', 'comer√≠a': 'comer', 'comer√≠amos': 'comer', 'comer√≠ais': 'comer', 'comer√≠an': 'comer',
                'vivir√≠a': 'vivir', 'vivir√≠as': 'vivir', 'vivir√≠a': 'vivir', 'vivir√≠amos': 'vivir', 'vivir√≠ais': 'vivir', 'vivir√≠an': 'vivir',
                'dir√≠a': 'decir', 'dir√≠as': 'decir', 'dir√≠a': 'decir', 'dir√≠amos': 'decir', 'dir√≠ais': 'decir', 'dir√≠an': 'decir',
                'har√≠a': 'hacer', 'har√≠as': 'hacer', 'har√≠a': 'hacer', 'har√≠amos': 'hacer', 'har√≠ais': 'hacer', 'har√≠an': 'hacer',
                'podr√≠a': 'poder', 'podr√≠as': 'poder', 'podr√≠a': 'poder', 'podr√≠amos': 'poder', 'podr√≠ais': 'poder', 'podr√≠an': 'poder',
                // Presente de Subjuntivo
                'hable': 'hablar', 'hables': 'hablar', 'hablemos': 'hablar', 'habl√©is': 'hablar', 'hablen': 'hablar',
                'coma': 'comer', 'comas': 'comer', 'comamos': 'comer', 'com√°is': 'comer', 'coman': 'comer',
                'viva': 'vivir', 'vivas': 'vivir', 'vivamos': 'vivir', 'viv√°is': 'vivir', 'vivan': 'vivir',
                'sea': 'ser', 'seas': 'ser', 'seamos': 'ser', 'se√°is': 'ser', 'sean': 'ser',
                'est√©': 'estar', 'est√©s': 'estar', 'estemos': 'estar', 'est√©is': 'estar', 'est√©n': 'estar',
                'vaya': 'ir', 'vayas': 'ir', 'vaya': 'ir', 'vayamos': 'ir', 'vay√°is': 'ir', 'vayan': 'ir',
                'tenga': 'tener', 'tengas': 'tener', 'tengamos': 'tener', 'teng√°is': 'tener', 'tengan': 'tener',
                'haga': 'hacer', 'hagas': 'hacer', 'hagamos': 'hacer', 'hag√°is': 'hacer', 'hagan': 'hacer',
                'pueda': 'poder', 'puedas': 'poder', 'pueda': 'poder', 'podamos': 'poder', 'pod√°is': 'poder', 'puedan': 'poder',
                'quiera': 'querer', 'quieras': 'querer', 'quiera': 'querer', 'queramos': 'querer', 'quer√°is': 'querer', 'quieran': 'querer',
                'diga': 'decir', 'digas': 'decir', 'digamos': 'decir', 'dig√°is': 'decir', 'digan': 'decir',
                'sepa': 'saber', 'sepas': 'saber', 'sepamos': 'saber', 'sep√°is': 'saber', 'sepan': 'saber',
                'd√©': 'dar', 'des': 'dar', 'demos': 'dar', 'deis': 'dar', 'den': 'dar',
                'conozca': 'conocer', 'conozcas': 'conocer', 'conozcamos': 'conocer', 'conozc√°is': 'conocer', 'conozcan': 'conocer',
                'oiga': 'o√≠r', 'oigas': 'o√≠r', 'oigamos': 'o√≠r', 'oig√°is': 'o√≠r', 'oigan': 'o√≠r',
                'duerma': 'dormir', 'duermas': 'dormir', 'duerma': 'dormir', 'durmamos': 'dormir', 'durm√°is': 'dormir', 'duerman': 'dormir',
                'pida': 'pedir', 'pidas': 'pedir', 'pida': 'pedir', 'pidamos': 'pedir', 'pid√°is': 'pedir', 'pidan': 'pidan',
                // Imperfecto de Subjuntivo (-ra form)
                'hablara': 'hablar', 'hablaras': 'hablar', 'hablara': 'hablar', 'habl√°ramos': 'hablar', 'hablarais': 'hablar', 'hablaran': 'hablar',
                'comiera': 'comer', 'comieras': 'comer', 'comiera': 'comer', 'comi√©ramos': 'comer', 'comierais': 'comer', 'comieran': 'comer',
                'viviera': 'vivir', 'vivieras': 'vivir', 'viviera': 'vivir', 'vivi√©ramos': 'vivir', 'vivierais': 'vivir', 'vivieran': 'vivir',
                'fuera': 'ser/ir', 'fueras': 'ser/ir', 'fuera': 'ser/ir', 'fu√©ramos': 'ser/ir', 'fuerais': 'ser/ir', 'fueran': 'ser/ir',
                'estuviera': 'estar', 'estuvieras': 'estar', 'estuviera': 'estar', 'estuvi√©ramos': 'estar', 'estuvierais': 'estar', 'estuvieran': 'estar',
                'tuviera': 'tener', 'tuvieras': 'tener', 'tuviera': 'tener', 'tuvi√©ramos': 'tener', 'tuvierais': 'tener', 'tuvieran': 'tener',
                'hiciera': 'hacer', 'hicieras': 'hacer', 'hiciera': 'hacer', 'hici√©ramos': 'hacer', 'hicierais': 'hacer', 'hicieran': 'hacer',
                'pudiera': 'poder', 'pudieras': 'poder', 'pudiera': 'poder', 'pudi√©ramos': 'poder', 'pudierais': 'poder', 'pudieran': 'poder',
                'dijera': 'decir', 'dijeras': 'decir', 'dijera': 'decir', 'dij√©ramos': 'decir', 'dijerais': 'decir', 'dijeran': 'decir',
                'viniera': 'venir', 'vinieras': 'venir', 'viniera': 'venir', 'vini√©ramos': 'venir', 'vinierais': 'venir', 'vinieran': 'venir',
                'supiera': 'saber', 'supieras': 'saber', 'supiera': 'saber', 'supi√©ramos': 'saber', 'supierais': 'saber', 'supieran': 'saber',
                'pusiera': 'poner', 'pusieras': 'poner', 'pusiera': 'poner', 'pusi√©ramos': 'poner', 'pusierais': 'poner', 'pusieran': 'poner',
                'quisiera': 'querer', 'quisieras': 'querer', 'quisiera': 'querer', 'quisi√©ramos': 'querer', 'quisierais': 'querer', 'quisieran': 'querer',
                'trajera': 'traer', 'trajeras': 'traer', 'trajera': 'traer', 'traj√©ramos': 'traer', 'trajierais': 'traer', 'trajieran': 'traer',
                'durmiera': 'dormir', 'durmieras': 'dormir', 'durmiera': 'dormir', 'durmi√©ramos': 'dormir', 'durmierais': 'dormir', 'durmieran': 'dormir',
                'pidiera': 'pedir', 'pidieras': 'pedir', 'pidiera': 'pedir', 'pidi√©ramos': 'pedir', 'pidierais': 'pedir', 'pidieran': 'pidieran',
                'volviera': 'volver', 'volvieras': 'volver', 'volvi√©ramos': 'volver', 'volvierais': 'volver', 'volvieran': 'volver'
            };

            // List of common verbs for random suggestion
            const randomVerbsList = [
                'hablar', 'comer', 'vivir', 'ser', 'estar', 'ir', 'tener', 'hacer', 'poder', 'querer',
                'decir', 'ver', 'jugar', 'salir', 'poner', 'saber', 'conocer', 'dar', 'venir', 'leer',
                'escribir', 'abrir', 'dormir', 'pedir', 'sentir', 'encontrar', 'volver', 'empezar', 'pensar',
                'levantar', 'levantarse',
                'esperar', 'alegrarse', 'dudar', 'aconsejar'
            ];

            // Categorized verbs for random suggestion
            const categorizedVerbs = {
                regular_ar: ['hablar', 'cantar', 'estudiar', 'bailar', 'comprar', 'escuchar'],
                regular_er: ['comer', 'beber', 'aprender', 'correr', 'vender', 'leer'],
                regular_ir: ['vivir', 'escribir', 'abrir', 'subir', 'recibir', 'decidir'],
                irregular_common: ['ser', 'estar', 'ir', 'tener', 'hacer', 'poder', 'querer', 'decir', 'ver', 'saber', 'dar', 'venir', 'poner', 'salir', 'volver'],
                reflexive: ['levantarse', 'ducharse', 'vestirse', 'acostarse', 'sentarse', 'llamarse'],
                stem_changing_e_ie: ['querer', 'empezar', 'pensar', 'cerrar', 'entender', 'perder', 'sentir'],
                stem_changing_o_ue: ['poder', 'dormir', 'encontrar', 'volver', 'costar', 'morir'],
                stem_changing_e_i: ['pedir', 'servir', 'repetir', 'seguir', 'vestir'],
                go_verbs_present: ['tener', 'venir', 'salir', 'poner', 'decir', 'o√≠r', 'traer', 'caer'], // verbs with 'go' in yo form
                z_c_verbs_present: ['conocer', 'producir', 'traducir', 'conducir'], // verbs with 'zco' in yo form
                irregular_future_cond: ['decir', 'hacer', 'poder', 'poner', 'haber', 'saber', 'salir', 'tener', 'venir', 'querer'],
                subjunctive_common_irreg: ['ser', 'estar', 'ir', 'haber', 'saber', 'dar', 'conocer', 'hacer', 'decir', 'tener', 'venir', 'o√≠r', 'poder', 'querer', 'pedir', 'dormir'],
                imperative_irreg: ['decir', 'hacer', 'ir', 'poner', 'salir', 'ser', 'tener', 'ven', 'volver']
            };


            function conjugate(verb, tense) {
                verb = verb.toLowerCase().trim();
                if (!verb) return null;

                const tenseData = verbData[tense];
                if (!tenseData) return null;

                if (tenseData.irreg[verb]) {
                    return tenseData.irreg[verb];
                }

                // Handle future and conditional regular verbs (endings added to infinitive)
                if (tense === 'futuro' || tense === 'condicional') {
                    const endings = tenseData.reg;
                    if (!endings) return null;
                    return endings.map(e => verb + e);
                }

                // Handle subjunctive regular verbs (stem changes based on indicative 'yo' form)
                if (tense === 'presente_subjuntivo' || tense === 'imperfecto_subjuntivo') {
                    let stem;
                    // For Presente de Subjuntivo, base stem on 'yo' form of Presente de Indicativo
                    if (tense === 'presente_subjuntivo') {
                        const yoFormIndicative = conjugate(verb, 'presente')[0];
                        if (!yoFormIndicative) return null; // Cannot get yo form for stem derivation
                        stem = yoFormIndicative.slice(0, -1); // Remove 'o'
                    } else { // imperfecto_subjuntivo
                        // For Imperfecto de Subjuntivo, base stem on 3rd person plural of Preterite
                        const ellosFormPreterite = conjugate(verb, 'indefinido')[5]; // 3rd person plural preterite
                        if (!ellosFormPreterite) return null; // Cannot get ellos form for stem derivation
                        stem = ellosFormPreterite.slice(0, ellosFormPreterite.length - 4); // Remove 'eron' or 'aron'
                    }

                    const endings = tenseData.reg[verb.slice(-2)]; // Get endings based on original infinitive ending
                    if (!endings) return null;

                    // Specific stem changes for subjunctive that are not derived from indicative 'yo' form
                    // These are often irregulars that have specific patterns, or verbs with vowel changes in specific persons.
                    // For a comprehensive solution, this would require a more complex lookup or a dedicated library.
                    // For now, these are hardcoded based on common irregular patterns.
                    if (verb === 'dormir' && tense === 'presente_subjuntivo') {
                        return ['duerma', 'duermas', 'duerma', 'durmamos', 'durm√°is', 'duerman'];
                    }
                    if (verb === 'pedir' && tense === 'presente_subjuntivo') {
                        return ['pida', 'pidas', 'pida', 'pidamos', 'pid√°is', 'pidan'];
                    }
                    // For imperfecto_subjuntivo, stem is derived from preterite, so it handles many irregularities.
                    
                    return endings.map(e => stem + e);
                }

                // Handle Imperative
                if (tense === 'imperativo') {
                    const result = [];
                    const subjPresente = conjugate(verb, 'presente_subjuntivo');
                    const irregImperative = tenseData.irreg[verb];

                    if (!subjPresente) return null; // Imperative relies heavily on subjunctive

                    // T√∫ (affirmative)
                    if (irregImperative && irregImperative.tu_aff) {
                        result.push(irregImperative.tu_aff);
                    } else {
                        // Regular t√∫ affirmative is same as √©l/ella presente indicativo
                        const elEllaPresente = conjugate(verb, 'presente')[2];
                        if (!elEllaPresente) return null;
                        result.push(elEllaPresente);
                    }

                    // T√∫ (negative) - uses presente subjuntivo 't√∫' form
                    result.push('no ' + subjPresente[1]);

                    // Usted - uses presente subjuntivo 'usted' form
                    result.push(subjPresente[2]);

                    // Nosotros/as - uses presente subjuntivo 'nosotros' form
                    result.push(subjPresente[3]);

                    // Vosotros/as (affirmative)
                    if (irregImperative && irregImperative.vos_aff) {
                        result.push(irregImperative.vos_aff);
                    } else {
                        // Regular vosotros affirmative: replace -r of infinitive with -d
                        const infinitiveEnding = verb.slice(-2);
                        if (infinitiveEnding === 'ar' || infinitiveEnding === 'er' || infinitiveEnding === 'ir') {
                            result.push(verb.slice(0, -1) + 'd');
                        } else {
                            return null; // Should not happen for valid verbs
                        }
                    }

                    // Vosotros/as (negative) - uses presente subjuntivo 'vosotros' form
                    result.push('no ' + subjPresente[4]);

                    // Ustedes - uses presente subjuntivo 'ustedes' form
                    result.push(subjPresente[5]);

                    return result;
                }

                const ending = verb.slice(-2);
                const stem = verb.slice(0, -2);
                const endings = tenseData.reg[ending];
                if (!endings) return null;

                return endings.map(e => stem + e);
            }
            
            function conjugatePerfecto(verb) {
                verb = verb.toLowerCase().trim();
                if (!verb) return null;
                
                const tenseData = verbData.perfecto;
                const haberForms = tenseData.haber;
                
                let participle;
                if (tenseData.participles.irreg[verb]) {
                    participle = tenseData.participles.irreg[verb];
                } else {
                    const ending = verb.slice(-2);
                    const stem = verb.slice(0, -2);
                    const participleEnding = tenseData.participles.reg[ending];
                    if (!participleEnding) return null;
                    participle = stem + participleEnding;
                }
                
                return haberForms.map(h => `${h} ${participle}`);
            }

            function conjugateCompoundPerfect(verb, tenseKey) {
                verb = verb.toLowerCase().trim();
                if (!verb) return null;

                const tenseData = verbData[tenseKey];
                const haberForms = tenseData[`haber_${tenseKey.split('_')[0]}`]; // e.g., haber_imp, haber_fut, haber_cond

                let participle;
                // Check if the verb has an irregular participle defined in the main perfecto.participles
                if (verbData.perfecto.participles.irreg[verb]) {
                    participle = verbData.perfecto.participles.irreg[verb];
                } else {
                    const ending = verb.slice(-2);
                    const stem = verb.slice(0, -2);
                    const participleEnding = verbData.perfecto.participles.reg[ending];
                    if (!participleEnding) return null;
                    participle = stem + participleEnding;
                }

                if (!haberForms || !participle) return null;

                return haberForms.map(h => `${h} ${participle}`);
            }

            function displayConjugation(verb, tense) {
                const resultDiv = document.getElementById(`conjugation-result-${tense}`);
                if (!resultDiv) return;

                let conjugations;
                if (['perfecto', 'pluscuamperfecto', 'futuro_perfecto', 'condicional_perfecto'].includes(tense)) {
                    conjugations = (tense === 'perfecto') ? conjugatePerfecto(verb) : conjugateCompoundPerfect(verb, tense);
                } else {
                    conjugations = conjugate(verb, tense);
                }
                
                if (!conjugations) {
                    resultDiv.innerHTML = `<p class="text-red-600">Verbo no encontrado o inv√°lido. Intenta con un infinitivo (e.g., hablar, comer, vivir).</p>`;
                    return;
                }

                const englishTranslation = verbTranslations[verb] || 'Translation N/A';

                let tableHTML = `<table class="w-full mt-4 border-collapse"><thead><tr><th class="table-cell table-header">Pronombre</th><th class="table-cell table-header">Conjugaci√≥n</th><th class="table-cell table-header">Traducci√≥n (English)</th></tr></thead><tbody>`;
                const currentPronouns = (tense === 'imperativo') ? imperativePronouns : pronouns;
                currentPronouns.forEach((pronoun, index) => {
                    tableHTML += `<tr><td class="table-cell">${pronoun}</td><td class="table-cell font-mono">${conjugations[index]}</td><td class="table-cell">${englishTranslation}</td></tr>`;
                });
                tableHTML += `</tbody></table>`;
                resultDiv.innerHTML = tableHTML;
            }

            function setupConjugator(tense) {
                const input = document.getElementById(`verb-input-${tense}`);
                const button = document.getElementById(`conjugate-btn-${tense}`);

                if (input && button) {
                    button.addEventListener('click', () => {
                        displayConjugation(input.value, tense);
                    });
                    input.addEventListener('keyup', (e) => {
                        if (e.key === 'Enter') {
                           displayConjugation(input.value, tense);
                        }
                    });
                }
            }

            function findInfinitive() {
                const input = document.getElementById('word-input-infinitivo');
                const resultDiv = document.getElementById('infinitive-result');
                const word = input.value.toLowerCase().trim();

                let normalizedWord = word;
                if (word.startsWith('me ') || word.startsWith('te ') || word.startsWith('se ') || word.startsWith('nos ') || word.startsWith('os ')) {
                    normalizedWord = word.substring(word.indexOf(' ') + 1);
                }
                normalizedWord = normalizedWord.normalize("NFD").replace(/[\u0300-\u036f]/g, "");


                if (!word) {
                    resultDiv.innerHTML = `<p class="text-red-600">Por favor, introduce una palabra.</p>`;
                    return;
                }

                const infinitive = infinitiveLookup[word] || infinitiveLookup[normalizedWord];
                if (infinitive) {
                    resultDiv.innerHTML = `<p>El infinitivo de "<b>${word}</b>" es: <span class="font-bold text-teal-700">${infinitive}</span></p>`;
                } else {
                    resultDiv.innerHTML = `<p class="text-red-600">No se encontr√≥ el infinitivo para "<b>${word}</b>". Intenta con una forma verbal com√∫n.</p>`;
                }
            }

            function identifyConjugationDetails(conjugatedWord) {
                conjugatedWord = conjugatedWord.toLowerCase().trim();
                const identificationResultDiv = document.getElementById('identification-result');
                identificationResultDiv.innerHTML = ''; // Clear previous results

                if (!conjugatedWord) {
                    identificationResultDiv.innerHTML = `<p class="text-red-600">Por favor, introduce una forma verbal para identificar.</p>`;
                    return;
                }

                const normalizedConjugatedWord = conjugatedWord.normalize("NFD").replace(/[\u0300-\u036f]/g, "");

                let baseForm = conjugatedWord;
                let isReflexive = false;
                const reflexivePrefixes = ['me ', 'te ', 'se ', 'nos ', 'os '];

                for (const prefix of reflexivePrefixes) {
                    if (conjugatedWord.startsWith(prefix)) {
                        baseForm = conjugatedWord.substring(prefix.length);
                        isReflexive = true;
                        break;
                    }
                }

                // Check for perfect tenses first (haber + participle)
                const haberForms = verbData.perfecto.haber;
                for (let i = 0; i < haberForms.length; i++) {
                    const haberForm = haberForms[i];
                    if (conjugatedWord.startsWith(haberForm + ' ')) {
                        const participlePart = conjugatedWord.substring(haberForm.length + 1);
                        const infinitive = infinitiveLookup[participlePart] || infinitiveLookup[participlePart.normalize("NFD").replace(/[\u0300-\u036f]/g, "")];
                        if (infinitive) {
                            const person = pronouns[i];
                            const tenseName = 'Pret√©rito Perfecto Compuesto';
                            identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseName}</span>, <span class="text-teal-700">${person}</span> del verbo <span class="font-bold text-teal-700">${infinitive.toUpperCase()}</span>.</p>`;
                            return;
                        }
                    }
                }
                
                // Check for Pluscuamperfecto (hab√≠a + participle)
                const haberImpForms = verbData.pluscuamperfecto.haber_imp;
                for (let i = 0; i < haberImpForms.length; i++) {
                    const haberImpForm = haberImpForms[i];
                    if (conjugatedWord.startsWith(haberImpForm + ' ')) {
                        const participlePart = conjugatedWord.substring(haberImpForm.length + 1);
                        const infinitive = infinitiveLookup[participlePart] || infinitiveLookup[participlePart.normalize("NFD").replace(/[\u0300-\u036f]/g, "")];
                        if (infinitive) {
                            const person = pronouns[i];
                            const tenseName = 'Pluscuamperfecto';
                            identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseName}</span>, <span class="text-teal-700">${person}</span> del verbo <span class="font-bold text-teal-700">${infinitive.toUpperCase()}</span>.</p>`;
                            return;
                        }
                    }
                }

                // Check for Futuro Perfecto (habr√© + participle)
                const haberFutForms = verbData.futuro_perfecto.haber_fut;
                for (let i = 0; i < haberFutForms.length; i++) {
                    const haberFutForm = haberFutForms[i];
                    if (conjugatedWord.startsWith(haberFutForm + ' ')) {
                        const participlePart = conjugatedWord.substring(haberFutForm.length + 1);
                        const infinitive = infinitiveLookup[participlePart] || infinitiveLookup[participlePart.normalize("NFD").replace(/[\u0300-\u036f]/g, "")];
                        if (infinitive) {
                            const person = pronouns[i];
                            const tenseName = 'Futuro Perfecto';
                            identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseName}</span>, <span class="text-teal-700">${person}</span> del verbo <span class="font-bold text-teal-700">${infinitive.toUpperCase()}</span>.</p>`;
                            return;
                        }
                    }
                }

                // Check for Condicional Perfecto (habr√≠a + participle)
                const haberCondForms = verbData.condicional_perfecto.haber_cond;
                for (let i = 0; i < haberCondForms.length; i++) {
                    const haberCondForm = haberCondForms[i];
                    if (conjugatedWord.startsWith(haberCondForm + ' ')) {
                        const participlePart = conjugatedWord.substring(haberCondForm.length + 1);
                        const infinitive = infinitiveLookup[participlePart] || infinitiveLookup[participlePart.normalize("NFD").replace(/[\u0300-\u036f]/g, "")];
                        if (infinitive) {
                            const person = pronouns[i];
                            const tenseName = 'Condicional Perfecto';
                            identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseName}</span>, <span class="text-teal-700">${person}</span> del verbo <span class="font-bold text-teal-700">${infinitive.toUpperCase()}</span>.</p>`;
                            return;
                        }
                    }
                }

                const tenseDisplayNames = {
                    'presente': 'Presente de Indicativo',
                    'indefinido': 'Pret√©rito Indefinido',
                    'imperfecto': 'Pret√©rito Imperfecto',
                    'futuro': 'Futuro Simple',
                    'condicional': 'Condicional Simple',
                    'presente_subjuntivo': 'Presente de Subjuntivo',
                    'imperfecto_subjuntivo': 'Imperfecto de Subjuntivo',
                    'imperativo': 'Imperativo'
                };
                const allTenses = ['presente', 'indefinido', 'imperfecto', 'futuro', 'condicional', 'presente_subjuntivo', 'imperfecto_subjuntivo', 'imperativo'];

                for (const tenseKey of allTenses) { // Iterate through all defined tenses
                    if (['perfecto', 'pluscuamperfecto', 'futuro_perfecto', 'condicional_perfecto'].includes(tenseKey)) continue; // Already handled compound tenses

                    const tenseInfo = verbData[tenseKey];
                    
                    // Try irregular verbs first
                    for (const infinitiveVerb in tenseInfo.irreg) {
                        const conjugations = tenseInfo.irreg[infinitiveVerb];
                        // Imperative irregulars are special, check them directly
                        if (tenseKey === 'imperativo' && tenseInfo.irreg[infinitiveVerb]) {
                            const irregForms = tenseInfo.irreg[infinitiveVerb];
                            const imperativePersons = ['tu_aff', 'vos_aff']; // Specific keys for imperative irregulars
                            for (const p of imperativePersons) {
                                if (irregForms[p] && irregForms[p].toLowerCase() === baseForm) {
                                    let displayInfinitive = infinitiveVerb.toUpperCase();
                                    if (isReflexive && !displayInfinitive.endsWith('SE')) {
                                        displayInfinitive += 'SE';
                                    }
                                    identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseDisplayNames[tenseKey]}</span>, <span class="text-teal-700">${p.replace('_aff', ' (afirmativo)')}</span> del verbo <span class="font-bold text-teal-700">${displayInfinitive}</span>.</p>`;
                                    return;
                                }
                            }
                            // Also check subjunctive-derived forms for imperative
                            const subjForms = conjugate(infinitiveVerb, 'presente_subjuntivo');
                            if (subjForms) {
                                // Negative t√∫, Usted, Nosotros, Ustedes forms
                                if (('no ' + subjForms[1]).toLowerCase() === conjugatedWord) { // Negative t√∫
                                    identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseDisplayNames[tenseKey]}</span>, <span class="text-teal-700">T√∫ (negativo)</span> del verbo <span class="font-bold text-teal-700">${infinitiveVerb.toUpperCase()}</span>.</p>`;
                                    return;
                                }
                                if (subjForms[2].toLowerCase() === baseForm) { // Usted
                                    identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseDisplayNames[tenseKey]}</span>, <span class="text-teal-700">Usted</span> del verbo <span class="font-bold text-teal-700">${infinitiveVerb.toUpperCase()}</span>.</p>`;
                                    return;
                                }
                                if (subjForms[3].toLowerCase() === baseForm) { // Nosotros
                                    identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseDisplayNames[tenseKey]}</span>, <span class="text-teal-700">Nosotros/as</span> del verbo <span class="font-bold text-teal-700">${infinitiveVerb.toUpperCase()}</span>.</p>`;
                                    return;
                                }
                                if (('no ' + subjForms[4]).toLowerCase() === conjugatedWord) { // Negative vosotros
                                     identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseDisplayNames[tenseKey]}</span>, <span class="text-teal-700">Vosotros/as (negativo)</span> del verbo <span class="font-bold text-teal-700">${infinitiveVerb.toUpperCase()}</span>.</p>`;
                                    return;
                                }
                                if (subjForms[5].toLowerCase() === baseForm) { // Ustedes
                                    identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseDisplayNames[tenseKey]}</span>, <span class="text-teal-700">Ustedes</span> del verbo <span class="font-bold text-teal-700">${infinitiveVerb.toUpperCase()}</span>.</p>`;
                                    return;
                                }
                            }
                        } else { // Standard irregulars (non-imperative)
                            for (let i = 0; i < conjugations.length; i++) {
                                const conjugatedForm = conjugations[i];
                                if (conjugatedForm.toLowerCase() === baseForm || conjugatedForm.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "") === normalizedConjugatedWord) {
                                    let displayInfinitive = infinitiveVerb.toUpperCase();
                                    if (isReflexive && !displayInfinitive.endsWith('SE')) {
                                        displayInfinitive += 'SE';
                                    }
                                    identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseDisplayNames[tenseKey]}</span>, <span class="text-teal-700">${pronouns[i]}</span> del verbo <span class="font-bold text-teal-700">${displayInfinitive}</span>.</p>`;
                                    return;
                                }
                            }
                        }
                    }

                    // Try regular verbs
                    for (const infinitiveVerb of Object.keys(verbTranslations)) {
                        if (tenseInfo.irreg[infinitiveVerb]) continue; // Skip irregulars already checked

                        const generatedConjugations = conjugate(infinitiveVerb, tenseKey);
                        if (generatedConjugations) {
                            for (let i = 0; i < generatedConjugations.length; i++) {
                                const genForm = generatedConjugations[i];
                                if (genForm && (genForm.toLowerCase() === baseForm || genForm.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "") === normalizedConjugatedWord)) {
                                    let displayInfinitive = infinitiveVerb.toUpperCase();
                                    if (isReflexive && !displayInfinitive.endsWith('SE')) {
                                        displayInfinitive += 'SE';
                                    }
                                    identificationResultDiv.innerHTML = `<p><b>${conjugatedWord}</b>: <span class="text-teal-700">${tenseDisplayNames[tenseKey]}</span>, <span class="text-teal-700">${tenseKey === 'imperativo' ? imperativePronouns[i] : pronouns[i]}</span> del verbo <span class="font-bold text-teal-700">${displayInfinitive}</span>.</p>`;
                                    return;
                                }
                            }
                        }
                    }
                }

                identificationResultDiv.innerHTML = `<p class="text-red-600">No se pudo identificar la conjugaci√≥n de "<b>${conjugatedWord}</b>". Intenta con una forma verbal com√∫n.</p>`;
            }
            
            document.addEventListener('DOMContentLoaded', () => {
                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        tabs.forEach(t => t.classList.remove('tab-active'));
                        contents.forEach(c => c.classList.add('hidden'));

                        tab.classList.add('tab-active');
                        document.getElementById(tab.dataset.tab).classList.remove('hidden');
                    });
                });

                tabs[0].classList.add('tab-active');
                contents[0].classList.remove('hidden');
                setupConjugator('presente');
                setupConjugator('indefinido');
                setupConjugator('imperfecto');
                setupConjugator('perfecto');
                setupConjugator('futuro');
                setupConjugator('condicional');
                setupConjugator('presente_subjuntivo');
                setupConjugator('imperfecto_subjuntivo');
                setupConjugator('pluscuamperfecto');
                setupConjugator('futuro_perfecto');
                setupConjugator('condicional_perfecto');
                setupConjugator('imperativo');

                const findInfinitiveButton = document.getElementById('find-infinitive-btn');
                const infinitiveInput = document.getElementById('word-input-infinitivo');
                if (findInfinitiveButton && infinitiveInput) {
                    findInfinitiveButton.addEventListener('click', findInfinitive);
                    infinitiveInput.addEventListener('keyup', (e) => {
                        if (e.key === 'Enter') {
                            findInfinitive();
                        }
                    });
                }

                const identifyVerbInput = document.getElementById('identify-verb-input');
                const identifyVerbBtn = document.getElementById('identify-verb-btn');
                if (identifyVerbInput && identifyVerbBtn) {
                    identifyVerbBtn.addEventListener('click', () => identifyConjugationDetails(identifyVerbInput.value));
                    identifyVerbInput.addEventListener('keyup', (e) => {
                        if (e.key === 'Enter') {
                            identifyConjugationDetails(identifyVerbInput.value);
                        }
                    });
                }

                const currentPracticeVerbs = {};

                function setupPracticeMode(tense) {
                    const startBtn = document.getElementById(`start-practice-btn-${tense}`);
                    const practiceVerbInput = document.getElementById(`practice-verb-input-${tense}`);
                    const practiceTableDiv = document.getElementById(`practice-table-${tense}`);
                    const checkBtn = document.getElementById(`check-practice-btn-${tense}`);
                    const showBtn = document.getElementById(`show-practice-btn-${tense}`);
                    const feedbackDiv = document.getElementById(`practice-feedback-${tense}`);
                    const randomVerbBtn = document.getElementById(`random-verb-btn-${tense}`);
                    const categorySelect = document.getElementById(`practice-category-${tense}`); // Get category select

                    if (!startBtn) return;

                    startBtn.addEventListener('click', () => {
                        const verb = practiceVerbInput.value.toLowerCase().trim();
                        if (!verb) {
                            feedbackDiv.textContent = 'Por favor, introduce un verbo para practicar.';
                            feedbackDiv.className = 'mt-4 text-center font-bold text-red-600';
                            practiceTableDiv.innerHTML = '';
                            checkBtn.classList.add('hidden');
                            showBtn.classList.add('hidden');
                            return;
                        }

                        let correctConjugations;
                        if (['perfecto', 'pluscuamperfecto', 'futuro_perfecto', 'condicional_perfecto'].includes(tense)) {
                            correctConjugations = (tense === 'perfecto') ? conjugatePerfecto(verb) : conjugateCompoundPerfect(verb, tense);
                        } else {
                            correctConjugations = conjugate(verb, tense);
                        }

                        if (!correctConjugations) {
                            feedbackDiv.textContent = 'Verbo no v√°lido para practicar en este tiempo.';
                            feedbackDiv.className = 'mt-4 text-center font-bold text-red-600';
                            practiceTableDiv.innerHTML = '';
                            checkBtn.classList.add('hidden');
                            showBtn.classList.add('hidden');
                            return;
                        }

                        currentPracticeVerbs[tense] = { verb: verb, conjugations: correctConjugations };
                        feedbackDiv.textContent = '';
                        feedbackDiv.className = 'mt-4 text-center font-bold';

                        let tableHTML = `<table class="w-full mt-4 border-collapse"><thead><tr><th class="table-cell table-header">Pronombre</th><th class="table-cell table-header">Tu Conjugaci√≥n</th><th class="table-cell table-header">Feedback</th></tr></thead><tbody>`;
                        const currentPracticePronouns = (tense === 'imperativo') ? imperativePronouns : pronouns;
                        currentPracticePronouns.forEach((pronoun, index) => {
                            tableHTML += `<tr>
                                <td class="table-cell">${pronoun}</td>
                                <td class="table-cell"><input type="text" class="practice-input w-full px-2 py-1 border border-stone-300 rounded-md text-sm" data-index="${index}"></td>
                                <td class="table-cell"><span class="feedback-icon" id="feedback-${tense}-${index}"></span></td>
                            </tr>`;
                        });
                        tableHTML += `</tbody></table>`;
                        practiceTableDiv.innerHTML = tableHTML;

                        checkBtn.classList.remove('hidden');
                        showBtn.classList.remove('hidden');
                    });

                    checkBtn.addEventListener('click', () => {
                        checkPracticeAnswers(tense);
                    });

                    showBtn.addEventListener('click', () => {
                        showPracticeAnswers(tense);
                    });

                    if (randomVerbBtn && categorySelect) { // Ensure categorySelect exists
                        randomVerbBtn.addEventListener('click', () => {
                            const selectedCategory = categorySelect.value;
                            let verbsToChooseFrom = [];

                            if (selectedCategory === 'all') {
                                verbsToChooseFrom = randomVerbsList;
                            } else {
                                verbsToChooseFrom = categorizedVerbs[selectedCategory] || [];
                            }

                            if (verbsToChooseFrom.length > 0) {
                                const randomIndex = Math.floor(Math.random() * verbsToChooseFrom.length);
                                practiceVerbInput.value = verbsToChooseFrom[randomIndex];
                                startBtn.click();
                            } else {
                                feedbackDiv.textContent = 'No hay verbos en esta categor√≠a para practicar.';
                                feedbackDiv.className = 'mt-4 text-center font-bold text-red-600';
                            }
                        });
                    }
                }

                function checkPracticeAnswers(tense) {
                    const practiceInputs = document.querySelectorAll(`#practice-table-${tense} .practice-input`);
                    const feedbackDiv = document.getElementById(`practice-feedback-${tense}`);
                    const correctConjugations = currentPracticeVerbs[tense].conjugations;
                    let allCorrect = true;
                    let correctCount = 0;

                    practiceInputs.forEach(input => {
                        const index = parseInt(input.dataset.index);
                        const userAnswer = input.value.toLowerCase().trim();
                        const correctAnswer = correctConjugations[index].toLowerCase().trim();
                        const feedbackIcon = document.getElementById(`feedback-${tense}-${index}`);

                        if (userAnswer === correctAnswer) {
                            feedbackIcon.textContent = '‚úÖ';
                            feedbackIcon.className = 'feedback-icon feedback-correct';
                            input.classList.remove('border-red-500');
                            input.classList.add('border-green-500');
                            correctCount++;
                        } else {
                            feedbackIcon.textContent = '‚ùå';
                            feedbackIcon.className = 'feedback-icon feedback-incorrect';
                            input.classList.remove('border-green-500');
                            input.classList.add('border-red-500');
                            allCorrect = false;
                        }
                    });

                    if (allCorrect) {
                        feedbackDiv.textContent = `¬°Felicidades! Todas las conjugaciones son correctas.`;
                        feedbackDiv.className = 'mt-4 text-center font-bold text-green-600';
                    } else {
                        const totalPronouns = (tense === 'imperativo' ? imperativePronouns.length : pronouns.length);
                        feedbackDiv.textContent = `Tienes ${correctCount} de ${totalPronouns} correctas. Sigue practicando.`;
                        feedbackDiv.className = 'mt-4 text-center font-bold text-red-600';
                    }
                }

                function showPracticeAnswers(tense) {
                    const practiceTableDiv = document.getElementById(`practice-table-${tense}`);
                    const feedbackDiv = document.getElementById(`practice-feedback-${tense}`);
                    const correctConjugations = currentPracticeVerbs[tense].conjugations;
                    const verb = currentPracticeVerbs[tense].verb;

                    const currentUserAnswers = Array.from(practiceTableDiv.querySelectorAll('.practice-input')).map(input => input.value);

                    let tableHTML = `<table class="w-full mt-4 border-collapse"><thead><tr>
                        <th class="table-cell table-header">Pronombre</th>
                        <th class="table-cell table-header">Tu Conjugaci√≥n</th>
                        <th class="table-cell table-header">Respuesta Correcta</th>
                        <th class="table-cell table-header">Feedback</th>
                    </tr></thead><tbody>`;

                    const currentPracticePronouns = (tense === 'imperativo') ? imperativePronouns : pronouns;
                    currentPracticePronouns.forEach((pronoun, index) => {
                        const userAnswer = currentUserAnswers[index];
                        const correctAnswer = correctConjugations[index];
                        const isCorrect = userAnswer.toLowerCase().trim() === correctAnswer.toLowerCase().trim();
                        const feedbackIcon = isCorrect ? '‚úÖ' : '‚ùå';
                        const feedbackClass = isCorrect ? 'feedback-correct' : 'feedback-incorrect';

                        tableHTML += `<tr>
                            <td class="table-cell">${pronoun}</td>
                            <td class="table-cell">
                                <input type="text" class="practice-input w-full px-2 py-1 border rounded-md text-sm ${isCorrect ? 'border-green-500' : 'border-red-500'}" value="${userAnswer}" data-index="${index}" disabled>
                            </td>
                            <td class="table-cell font-mono">${correctAnswer}</td>
                            <td class="table-cell"><span class="feedback-icon ${feedbackClass}">${feedbackIcon}</span></td>
                        </tr>`;
                    });
                    tableHTML += `</tbody></table>`;
                    practiceTableDiv.innerHTML = tableHTML;

                    feedbackDiv.textContent = 'Respuestas mostradas para comparaci√≥n.';
                    feedbackDiv.className = 'mt-4 text-center font-bold text-stone-600';
                }

                document.querySelectorAll('.mode-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const tense = button.dataset.tense;
                        const mode = button.dataset.mode;

                        document.querySelectorAll(`.mode-button[data-tense="${tense}"]`).forEach(btn => {
                            btn.classList.remove('mode-active');
                        });
                        button.classList.add('mode-active');

                        document.getElementById(`${tense}-view-mode`).classList.add('hidden');
                        document.getElementById(`${tense}-practice-mode`).classList.add('hidden');

                        document.getElementById(`${tense}-${mode}-mode`).classList.remove('hidden');

                        if (mode === 'view') {
                            document.getElementById(`practice-table-${tense}`).innerHTML = '';
                            document.getElementById(`practice-feedback-${tense}`).textContent = '';
                            document.getElementById(`check-practice-btn-${tense}`).classList.add('hidden');
                            document.getElementById(`show-practice-btn-${tense}`).classList.add('hidden');
                        }
                    });
                });

                setupPracticeMode('presente');
                setupPracticeMode('indefinido');
                setupPracticeMode('imperfecto');
                setupPracticeMode('perfecto');
                setupPracticeMode('futuro');
                setupPracticeMode('condicional');
                setupPracticeMode('presente_subjuntivo');
                setupPracticeMode('imperfecto_subjuntivo');
                setupPracticeMode('pluscuamperfecto');
                setupPracticeMode('futuro_perfecto');
                setupPracticeMode('condicional_perfecto');
                setupPracticeMode('imperativo');
            });
        })(); // IIFE ends here
    </script>
</body>
</html>
